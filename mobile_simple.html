<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>CallBunker Mobile</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, sans-serif;
            background: #f8f9fa;
            height: 100vh;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }
        
        .header {
            background: white;
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid #eee;
        }
        
        .header h1 {
            color: #1c1c1e;
            font-size: 20px;
            font-weight: 600;
        }
        
        .content {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
        }
        
        .screen {
            display: none;
        }
        
        .screen.active {
            display: block;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 16px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #007aff;
        }
        
        .stat-label {
            font-size: 12px;
            color: #8e8e93;
            margin-top: 4px;
        }
        
        .actions {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-top: 20px;
        }
        
        .action-btn {
            background: white;
            border: none;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            cursor: pointer;
        }
        
        .action-btn:active {
            transform: scale(0.95);
        }
        
        .action-icon {
            font-size: 28px;
            margin-bottom: 8px;
        }
        
        .action-title {
            font-size: 14px;
            font-weight: 600;
            color: #1c1c1e;
        }
        
        .action-subtitle {
            font-size: 12px;
            color: #8e8e93;
            margin-top: 4px;
        }
        
        /* Messages Screen */
        .messages-center {
            text-align: center;
            padding: 60px 20px;
        }
        
        .message-icon {
            font-size: 64px;
            margin-bottom: 16px;
            color: #c7c7cc;
        }
        
        .message-title {
            font-size: 24px;
            font-weight: 600;
            color: #1c1c1e;
            margin-bottom: 12px;
        }
        
        .message-subtitle {
            font-size: 16px;
            color: #8e8e93;
            line-height: 1.4;
        }
        
        /* Dialer */
        .dialer-container {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 16px;
        }
        
        .dialer-display {
            text-align: center;
            padding: 16px;
            background: white;
            border-radius: 12px;
            margin-bottom: 16px;
        }
        
        .phone-number {
            font-size: 28px;
            color: #1c1c1e;
            margin-bottom: 8px;
            min-height: 35px;
        }
        
        .privacy-badge {
            background: #e8f5e8;
            color: #4caf50;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            display: inline-block;
        }
        
        .dialpad {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 20px;
            flex: 1;
            align-content: center;
        }
        
        .dial-btn {
            height: 60px;
            width: 60px;
            justify-self: center;
            background: white;
            border: none;
            border-radius: 50%;
            font-size: 20px;
            font-weight: 300;
            color: #1c1c1e;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .dial-btn:active {
            transform: scale(0.95);
        }
        
        .dial-letters {
            font-size: 8px;
            color: #8e8e93;
            margin-top: -2px;
        }
        
        .call-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            align-items: center;
            padding-bottom: 10px;
        }
        
        .call-btn {
            width: 55px;
            height: 55px;
            border-radius: 28px;
            border: none;
            background: #4caf50;
            color: white;
            font-size: 22px;
            cursor: pointer;
        }
        
        .call-btn:active {
            transform: scale(0.95);
        }
        
        .back-btn {
            width: 45px;
            height: 45px;
            border-radius: 23px;
            border: none;
            background: #f2f2f7;
            color: #ff3b30;
            font-size: 18px;
            cursor: pointer;
        }
        
        .back-btn:active {
            transform: scale(0.95);
        }
        
        /* List Items */
        .list-item {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            cursor: pointer;
        }
        
        .list-item:active {
            transform: scale(0.98);
        }
        
        .list-avatar {
            width: 40px;
            height: 40px;
            border-radius: 20px;
            background: #f2f2f7;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 18px;
        }
        
        .list-content {
            flex: 1;
        }
        
        .list-title {
            font-size: 16px;
            font-weight: 500;
            color: #1c1c1e;
        }
        
        .list-subtitle {
            font-size: 14px;
            color: #8e8e93;
            margin-top: 2px;
        }
        
        .list-meta {
            font-size: 14px;
            color: #4caf50;
            font-weight: 500;
        }
        
        .list-arrow {
            color: #c7c7cc;
            font-size: 16px;
        }
        
        /* Detail Views */
        .detail-screen {
            display: none;
            padding: 16px;
        }
        
        .detail-screen.active {
            display: block;
        }
        
        .detail-header {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .back-arrow {
            background: none;
            border: none;
            font-size: 20px;
            color: #007aff;
            cursor: pointer;
            margin-right: 12px;
        }
        
        .detail-title {
            font-size: 18px;
            font-weight: 600;
            color: #1c1c1e;
        }
        
        .detail-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 12px;
        }
        
        .detail-label {
            font-size: 12px;
            color: #8e8e93;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 4px;
        }
        
        .detail-value {
            font-size: 16px;
            color: #1c1c1e;
            font-weight: 500;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }
        
        .feature-item {
            padding: 8px 0;
            border-bottom: 1px solid #f2f2f7;
            display: flex;
            align-items: center;
        }
        
        .feature-item:last-child {
            border-bottom: none;
        }
        
        .feature-icon {
            margin-right: 8px;
            color: #4caf50;
        }
        
        .feature-text {
            color: #1c1c1e;
            font-size: 14px;
        }
        
        /* Tab Bar */
        .tab-bar {
            background: white;
            border-top: 1px solid #eee;
            padding: 10px 0;
            display: grid;
            grid-template-columns: repeat(6, 1fr);
        }
        
        .tab {
            text-align: center;
            cursor: pointer;
            padding: 8px 4px;
        }
        
        .tab.active {
            color: #007aff;
        }
        
        .tab:not(.active) {
            color: #8e8e93;
        }
        
        .tab-icon {
            font-size: 20px;
            margin-bottom: 2px;
        }
        
        .tab-label {
            font-size: 10px;
            font-weight: 500;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1 id="screen-title">CallBunker</h1>
    </div>
    
    <div class="content">
        <!-- Home Screen -->
        <div class="screen active" id="home">
            <div class="card" onclick="showAnalytics()" style="cursor: pointer;">
                <div style="display: flex; align-items: center; margin-bottom: 16px;">
                    <div style="font-size: 32px; color: #4caf50; margin-right: 12px;">üõ°Ô∏è</div>
                    <div>
                        <div style="font-size: 18px; font-weight: 600; color: #1c1c1e;">Privacy Protected</div>
                        <div style="font-size: 14px; color: #8e8e93;">Your real number is hidden ‚Ä¢ Tap for details</div>
                    </div>
                </div>
                <div class="stats">
                    <div>
                        <div class="stat-number" id="blocked-calls-stat" style="color: #ff3b30;">6</div>
                        <div class="stat-label">Blocked Calls</div>
                    </div>
                    <div>
                        <div class="stat-number" id="trusted-contacts-stat" style="color: #4caf50;">2</div>
                        <div class="stat-label">Trusted Contacts</div>
                    </div>
                </div>
            </div>
            
            <div class="actions">
                <button class="action-btn" onclick="switchTab('dialer')">
                    <div class="action-icon" style="color: #007aff;">üìû</div>
                    <div class="action-title">Protected Call</div>
                    <div class="action-subtitle">Hide your number</div>
                </button>
                <button class="action-btn" onclick="switchTab('contacts')">
                    <div class="action-icon" style="color: #ff9500;">üë•</div>
                    <div class="action-title">Trusted Contacts</div>
                    <div class="action-subtitle">Manage whitelist</div>
                </button>
            </div>
        </div>
        
        <!-- Dialer Screen -->
        <div class="screen" id="dialer">
            <div class="dialer-container">
                <div class="dialer-display">
                    <div class="phone-number" id="phone-display">Enter number</div>
                    <div class="privacy-badge">üõ°Ô∏è Privacy Protected</div>
                </div>
                
                <div class="dialpad">
                    <button class="dial-btn" onclick="addDigit('1')">1</button>
                    <button class="dial-btn" onclick="addDigit('2')">2<br><span class="dial-letters">ABC</span></button>
                    <button class="dial-btn" onclick="addDigit('3')">3<br><span class="dial-letters">DEF</span></button>
                    <button class="dial-btn" onclick="addDigit('4')">4<br><span class="dial-letters">GHI</span></button>
                    <button class="dial-btn" onclick="addDigit('5')">5<br><span class="dial-letters">JKL</span></button>
                    <button class="dial-btn" onclick="addDigit('6')">6<br><span class="dial-letters">MNO</span></button>
                    <button class="dial-btn" onclick="addDigit('7')">7<br><span class="dial-letters">PQRS</span></button>
                    <button class="dial-btn" onclick="addDigit('8')">8<br><span class="dial-letters">TUV</span></button>
                    <button class="dial-btn" onclick="addDigit('9')">9<br><span class="dial-letters">WXYZ</span></button>
                    <button class="dial-btn" onclick="addDigit('*')">*</button>
                    <button class="dial-btn" onclick="addDigit('0')">0<br><span class="dial-letters">+</span></button>
                    <button class="dial-btn" onclick="addDigit('#')">#</button>
                </div>
                
                <div class="call-actions">
                    <button class="back-btn" onclick="backspace()">‚å´</button>
                    <button class="call-btn" onclick="makeCall()">üìû</button>
                </div>
            </div>
        </div>
        
        <!-- Messages Screen -->
        <div class="screen" id="messages">
            <div class="messages-center">
                <div class="message-icon">üí¨</div>
                <div class="message-title">SMS Coming Soon</div>
                <div class="message-subtitle">Secure messaging with privacy protection will be available shortly.</div>
            </div>
        </div>
        
        <!-- History Screen -->
        <div class="screen" id="history">
            <div class="list-item">
                <div class="list-avatar">üìû</div>
                <div class="list-content">
                    <div class="list-title">(555) 123-4567</div>
                    <div class="list-subtitle">2m ago</div>
                </div>
                <div class="list-meta">2:34</div>
            </div>
            <div class="list-item">
                <div class="list-avatar">üìû</div>
                <div class="list-content">
                    <div class="list-title">(555) 987-6543</div>
                    <div class="list-subtitle">1h ago</div>
                </div>
                <div class="list-meta">1:45</div>
            </div>
        </div>
        
        <!-- Contacts Screen -->
        <div class="screen" id="contacts">
            <div style="background: #e8f5e8; padding: 16px; border-radius: 12px; margin-bottom: 16px; display: flex; align-items: center;">
                <span style="color: #4caf50; font-size: 20px; margin-right: 8px;">üõ°Ô∏è</span>
                <span style="color: #4caf50; font-size: 14px;">Trusted contacts bypass screening</span>
            </div>
            
            <div class="list-item" onclick="showContactDetail('john')">
                <div class="list-avatar" style="background: #007aff; color: white; font-weight: 600;">J</div>
                <div class="list-content">
                    <div class="list-title">John Smith</div>
                    <div class="list-subtitle">(555) 123-4567</div>
                </div>
                <div style="color: #4caf50;">‚úÖ</div>
            </div>
            <div class="list-item" onclick="showContactDetail('mary')">
                <div class="list-avatar" style="background: #007aff; color: white; font-weight: 600;">M</div>
                <div class="list-content">
                    <div class="list-title">Mary Johnson</div>
                    <div class="list-subtitle">(555) 987-6543</div>
                </div>
                <div style="color: #007aff;">üîß</div>
            </div>
        </div>
        
        <!-- Settings Screen -->
        <div class="screen" id="settings">
            <div class="list-item" onclick="showDetail('security')">
                <div class="list-avatar">üõ°Ô∏è</div>
                <div class="list-content">
                    <div class="list-title">Security Settings</div>
                    <div class="list-subtitle">PIN: 8322, Verbal: "Black widow"</div>
                </div>
                <div class="list-arrow">‚Ä∫</div>
            </div>
            <div class="list-item" onclick="showDetail('privacy')">
                <div class="list-avatar">üìû</div>
                <div class="list-content">
                    <div class="list-title">Privacy Protection</div>
                    <div class="list-subtitle">Google Voice Integration</div>
                </div>
                <div class="list-arrow">‚Ä∫</div>
            </div>
            <div class="list-item" onclick="showDetail('about')">
                <div class="list-avatar">‚ÑπÔ∏è</div>
                <div class="list-content">
                    <div class="list-title">About CallBunker</div>
                    <div class="list-subtitle">Version 1.0.0</div>
                </div>
                <div class="list-arrow">‚Ä∫</div>
            </div>
        </div>
        
        <!-- Security Detail Screen -->
        <div class="detail-screen" id="security-detail">
            <div class="detail-header">
                <button class="back-arrow" onclick="hideDetail()">‚Äπ</button>
                <div class="detail-title">Security Settings</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">PIN Authentication</div>
                <div style="display: flex; align-items: center; margin-top: 8px;" id="pin-display">
                    <div style="flex: 1; padding: 8px; background: #f8f9fa; border-radius: 6px; font-size: 16px; margin-right: 8px; color: #1c1c1e;" id="pin-value">8322</div>
                    <button onclick="editPin()" style="background: #007aff; color: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 14px;">Edit</button>
                </div>
                <div style="display: none; align-items: center; margin-top: 8px;" id="pin-edit">
                    <input type="text" id="pin-input" value="8322" style="flex: 1; padding: 8px; border: 1px solid #e5e5ea; border-radius: 6px; font-size: 16px; margin-right: 8px;">
                    <button onclick="savePin()" style="background: #4caf50; color: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 14px; margin-right: 4px;">Save</button>
                    <button onclick="cancelPinEdit()" style="background: #8e8e93; color: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 14px;">Cancel</button>
                </div>
                <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">4-digit numeric code for call authentication</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Verbal Code</div>
                <div style="display: flex; align-items: center; margin-top: 8px;" id="verbal-display">
                    <div style="flex: 1; padding: 8px; background: #f8f9fa; border-radius: 6px; font-size: 16px; margin-right: 8px; color: #1c1c1e;" id="verbal-value">"Black widow"</div>
                    <button onclick="editVerbal()" style="background: #007aff; color: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 14px;">Edit</button>
                </div>
                <div style="display: none; align-items: center; margin-top: 8px;" id="verbal-edit">
                    <input type="text" id="verbal-input" value="Black widow" style="flex: 1; padding: 8px; border: 1px solid #e5e5ea; border-radius: 6px; font-size: 16px; margin-right: 8px;">
                    <button onclick="saveVerbal()" style="background: #4caf50; color: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 14px; margin-right: 4px;">Save</button>
                    <button onclick="cancelVerbalEdit()" style="background: #8e8e93; color: white; border: none; border-radius: 6px; padding: 8px 12px; font-size: 14px;">Cancel</button>
                </div>
                <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Spoken phrase for voice authentication</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Authentication Methods</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üî¢</span>
                        <span class="feature-text">PIN Code Entry</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üó£Ô∏è</span>
                        <span class="feature-text">Verbal Recognition</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">‚ö°</span>
                        <span class="feature-text">Dual Verification Support</span>
                    </li>
                </ul>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Security Features</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üõ°Ô∏è</span>
                        <span class="feature-text">Call Screening Protection</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üì±</span>
                        <span class="feature-text">Rate Limiting & Blocking</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">‚úÖ</span>
                        <span class="feature-text">Smart Trusted Caller Whitelist</span>
                    </li>
                </ul>
            </div>
        </div>
        
        <!-- Privacy Detail Screen -->
        <div class="detail-screen" id="privacy-detail">
            <div class="detail-header">
                <button class="back-arrow" onclick="hideDetail()">‚Äπ</button>
                <div class="detail-title">Privacy Protection</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Your Google Voice Number</div>
                <div class="detail-value">+1 (617) 942-1250</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Real Number Protection</div>
                <div class="detail-value">+1 (508) 638-8084 (Hidden)</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Privacy Features</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üé≠</span>
                        <span class="feature-text">Caller ID Spoofing</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üîí</span>
                        <span class="feature-text">Real Number Concealment</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üìû</span>
                        <span class="feature-text">Native Device Calling</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üåê</span>
                        <span class="feature-text">Google Voice Integration</span>
                    </li>
                </ul>
            </div>
            
            <div class="detail-card">
                <div style="background: #e8f5e8; padding: 12px; border-radius: 8px; display: flex; align-items: center;">
                    <span style="color: #4caf50; font-size: 20px; margin-right: 8px;">üõ°Ô∏è</span>
                    <span style="color: #4caf50; font-size: 14px;">Your real number remains completely hidden from contacts</span>
                </div>
            </div>
        </div>
        
        <!-- About Detail Screen -->
        <div class="detail-screen" id="about-detail">
            <div class="detail-header">
                <button class="back-arrow" onclick="hideDetail()">‚Äπ</button>
                <div class="detail-title">About CallBunker</div>
            </div>
            
            <div class="detail-card">
                <div style="text-align: center; padding: 20px;">
                    <div style="font-size: 48px; margin-bottom: 12px;">üõ°Ô∏è</div>
                    <div style="font-size: 20px; font-weight: 600; color: #1c1c1e; margin-bottom: 4px;">CallBunker</div>
                    <div style="font-size: 14px; color: #8e8e93;">Advanced Communication Security</div>
                </div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Version Information</div>
                <div class="detail-value">1.0.0</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Core Features</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üõ°Ô∏è</span>
                        <span class="feature-text">Call Screening with PIN/Verbal Auth</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üìû</span>
                        <span class="feature-text">Protected Native Calling</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üí¨</span>
                        <span class="feature-text">Secure Messaging (Coming Soon)</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üë•</span>
                        <span class="feature-text">Trusted Contacts Management</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üìä</span>
                        <span class="feature-text">Call History & Analytics</span>
                    </li>
                </ul>
            </div>
            

            
            <div class="detail-card">
                <div style="text-align: center; color: #8e8e93; font-size: 12px; line-height: 1.4;">
                    CallBunker provides comprehensive communication security through advanced call screening, privacy protection, and intelligent contact management. Your real phone number stays completely hidden while maintaining full functionality.
                </div>
            </div>
        </div>
        
        <!-- Analytics Detail Screen -->
        <div class="detail-screen" id="analytics-detail">
            <div class="detail-header">
                <button class="back-arrow" onclick="hideAnalytics()">‚Äπ</button>
                <div class="detail-title">Security Analytics</div>
            </div>
            
            <div class="detail-card">
                <div style="text-align: center; padding: 16px;">
                    <div style="font-size: 48px; color: #4caf50; margin-bottom: 12px;">üõ°Ô∏è</div>
                    <div style="font-size: 20px; font-weight: 600; color: #1c1c1e; margin-bottom: 4px;">Privacy Protection Active</div>
                    <div style="font-size: 14px; color: #8e8e93;">Your real number stays completely hidden</div>
                </div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Call Statistics (Last 30 Days)</div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 16px; margin-top: 12px;">
                    <div style="text-align: center;">
                        <div style="font-size: 28px; font-weight: bold; color: #4caf50;">5</div>
                        <div style="font-size: 12px; color: #8e8e93;">Protected Calls</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 28px; font-weight: bold; color: #007aff;">12</div>
                        <div style="font-size: 12px; color: #8e8e93;">Total Calls</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 28px; font-weight: bold; color: #ff9500;">7</div>
                        <div style="font-size: 12px; color: #8e8e93;">Screened Calls</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="font-size: 28px; font-weight: bold; color: #ff3b30;">3</div>
                        <div style="font-size: 12px; color: #8e8e93;">Blocked Attempts</div>
                    </div>
                </div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Protection Effectiveness</div>
                <div style="margin-top: 12px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                        <span style="font-size: 14px; color: #1c1c1e;">Privacy Success Rate</span>
                        <span style="font-size: 14px; font-weight: 600; color: #4caf50;">100%</span>
                    </div>
                    <div style="height: 6px; background: #f2f2f7; border-radius: 3px; overflow: hidden;">
                        <div style="height: 100%; width: 100%; background: #4caf50; border-radius: 3px;"></div>
                    </div>
                </div>
                <div style="margin-top: 16px;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 4px;">
                        <span style="font-size: 14px; color: #1c1c1e;">Authentication Rate</span>
                        <span style="font-size: 14px; font-weight: 600; color: #4caf50;">71%</span>
                    </div>
                    <div style="height: 6px; background: #f2f2f7; border-radius: 3px; overflow: hidden;">
                        <div style="height: 100%; width: 71%; background: #4caf50; border-radius: 3px;"></div>
                    </div>
                </div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Recent Activity</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon" style="color: #4caf50;">üìû</span>
                        <div>
                            <div class="feature-text">Protected call to (555) 123-4567</div>
                            <div style="font-size: 12px; color: #8e8e93;">2 hours ago</div>
                        </div>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon" style="color: #ff9500;">üõ°Ô∏è</span>
                        <div>
                            <div class="feature-text">Call screening: PIN verified</div>
                            <div style="font-size: 12px; color: #8e8e93;">5 hours ago</div>
                        </div>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon" style="color: #ff3b30;">üö´</span>
                        <div>
                            <div class="feature-text">Blocked unknown caller</div>
                            <div style="font-size: 12px; color: #8e8e93;">1 day ago</div>
                        </div>
                    </li>
                </ul>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Privacy Features Active</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üé≠</span>
                        <span class="feature-text">Caller ID Spoofing</span>
                        <span style="color: #4caf50; margin-left: auto;">‚úì</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üîí</span>
                        <span class="feature-text">Number Concealment</span>
                        <span style="color: #4caf50; margin-left: auto;">‚úì</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üõ°Ô∏è</span>
                        <span class="feature-text">Call Screening</span>
                        <span style="color: #4caf50; margin-left: auto;">‚úì</span>
                    </li>
                </ul>
            </div>
            
            <div class="detail-card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <div class="detail-label">Blocked Calls (6)</div>
                    <div id="blocked-actions">
                        <button onclick="clearAllBlocked()" style="background: #ff3b30; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px;">Clear All</button>
                    </div>
                    <div id="selection-actions" style="display: none;">
                        <span id="selection-count" style="font-size: 12px; color: #8e8e93; margin-right: 8px;">0 selected</span>
                        <button onclick="cancelSelection()" style="background: #8e8e93; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; margin-right: 4px;">Cancel</button>
                        <button onclick="whitelistSelected()" style="background: #4caf50; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; margin-right: 4px;">Whitelist Selected</button>
                        <button onclick="removeSelected()" style="background: #ff3b30; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px;">Remove Selected</button>
                    </div>
                </div>
                <div id="blocked-calls-list">
                    <div class="list-item blocked-call-item" style="margin-bottom: 8px; padding: 12px;" data-phone="(555) 999-8888">
                        <div class="selection-checkbox" style="display: none; margin-right: 12px; width: 20px; height: 20px; border: 2px solid #007aff; border-radius: 4px; position: relative;">
                            <div class="checkmark" style="display: none; position: absolute; top: 2px; left: 6px; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);"></div>
                        </div>
                        <div class="list-avatar" style="background: #ff3b30; color: white; font-size: 16px;">üö´</div>
                        <div class="list-content" style="position: relative;">
                            <div class="list-title">(555) 999-8888</div>
                            <div class="list-subtitle">Blocked 2 hours ago ‚Ä¢ Failed authentication</div>
                        </div>
                        <div class="item-actions" style="display: flex; gap: 4px;">
                            <button onclick="whitelistCall('(555) 999-8888')" style="background: #4caf50; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Whitelist</button>
                            <button onclick="removeBlocked('(555) 999-8888')" style="background: #8e8e93; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Remove</button>
                        </div>
                    </div>
                    
                    <div class="list-item blocked-call-item" style="margin-bottom: 8px; padding: 12px;" data-phone="(555) 123-0000">
                        <div class="selection-checkbox" style="display: none; margin-right: 12px; width: 20px; height: 20px; border: 2px solid #007aff; border-radius: 4px; position: relative;">
                            <div class="checkmark" style="display: none; position: absolute; top: 2px; left: 6px; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);"></div>
                        </div>
                        <div class="list-avatar" style="background: #ff3b30; color: white; font-size: 16px;">üö´</div>
                        <div class="list-content" style="position: relative;">
                            <div class="list-title">(555) 123-0000</div>
                            <div class="list-subtitle">Blocked 1 day ago ‚Ä¢ Unknown caller</div>
                        </div>
                        <div class="item-actions" style="display: flex; gap: 4px;">
                            <button onclick="whitelistCall('(555) 123-0000')" style="background: #4caf50; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Whitelist</button>
                            <button onclick="removeBlocked('(555) 123-0000')" style="background: #8e8e93; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Remove</button>
                        </div>
                    </div>
                    
                    <div class="list-item blocked-call-item" style="margin-bottom: 8px; padding: 12px;" data-phone="(555) 777-4444">
                        <div class="selection-checkbox" style="display: none; margin-right: 12px; width: 20px; height: 20px; border: 2px solid #007aff; border-radius: 4px; position: relative;">
                            <div class="checkmark" style="display: none; position: absolute; top: 2px; left: 6px; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);"></div>
                        </div>
                        <div class="list-avatar" style="background: #ff3b30; color: white; font-size: 16px;">üö´</div>
                        <div class="list-content" style="position: relative;">
                            <div class="list-title">(555) 777-4444</div>
                            <div class="list-subtitle">Blocked 3 days ago ‚Ä¢ Spam detected</div>
                        </div>
                        <div class="item-actions" style="display: flex; gap: 4px;">
                            <button onclick="whitelistCall('(555) 777-4444')" style="background: #4caf50; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Whitelist</button>
                            <button onclick="removeBlocked('(555) 777-4444')" style="background: #8e8e93; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Remove</button>
                        </div>
                    </div>
                    
                    <div class="list-item blocked-call-item" style="margin-bottom: 8px; padding: 12px;" data-phone="(555) 234-5678">
                        <div class="selection-checkbox" style="display: none; margin-right: 12px; width: 20px; height: 20px; border: 2px solid #007aff; border-radius: 4px; position: relative;">
                            <div class="checkmark" style="display: none; position: absolute; top: 2px; left: 6px; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);"></div>
                        </div>
                        <div class="list-avatar" style="background: #ff3b30; color: white; font-size: 16px;">üö´</div>
                        <div class="list-content" style="position: relative;">
                            <div class="list-title">(555) 234-5678</div>
                            <div class="list-subtitle">Blocked 5 hours ago ‚Ä¢ Invalid PIN</div>
                        </div>
                        <div class="item-actions" style="display: flex; gap: 4px;">
                            <button onclick="whitelistCall('(555) 234-5678')" style="background: #4caf50; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Whitelist</button>
                            <button onclick="removeBlocked('(555) 234-5678')" style="background: #8e8e93; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Remove</button>
                        </div>
                    </div>
                    
                    <div class="list-item blocked-call-item" style="margin-bottom: 8px; padding: 12px;" data-phone="(555) 876-5432">
                        <div class="selection-checkbox" style="display: none; margin-right: 12px; width: 20px; height: 20px; border: 2px solid #007aff; border-radius: 4px; position: relative;">
                            <div class="checkmark" style="display: none; position: absolute; top: 2px; left: 6px; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);"></div>
                        </div>
                        <div class="list-avatar" style="background: #ff3b30; color: white; font-size: 16px;">üö´</div>
                        <div class="list-content" style="position: relative;">
                            <div class="list-title">(555) 876-5432</div>
                            <div class="list-subtitle">Blocked 30 minutes ago ‚Ä¢ Suspicious activity</div>
                        </div>
                        <div class="item-actions" style="display: flex; gap: 4px;">
                            <button onclick="whitelistCall('(555) 876-5432')" style="background: #4caf50; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Whitelist</button>
                            <button onclick="removeBlocked('(555) 876-5432')" style="background: #8e8e93; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Remove</button>
                        </div>
                    </div>
                    
                    <div class="list-item blocked-call-item" style="margin-bottom: 8px; padding: 12px;" data-phone="(555) 321-9876">
                        <div class="selection-checkbox" style="display: none; margin-right: 12px; width: 20px; height: 20px; border: 2px solid #007aff; border-radius: 4px; position: relative;">
                            <div class="checkmark" style="display: none; position: absolute; top: 2px; left: 6px; width: 6px; height: 10px; border: solid white; border-width: 0 2px 2px 0; transform: rotate(45deg);"></div>
                        </div>
                        <div class="list-avatar" style="background: #ff3b30; color: white; font-size: 16px;">üö´</div>
                        <div class="list-content" style="position: relative;">
                            <div class="list-title">(555) 321-9876</div>
                            <div class="list-subtitle">Blocked 15 minutes ago ‚Ä¢ Too many attempts</div>
                        </div>
                        <div class="item-actions" style="display: flex; gap: 4px;">
                            <button onclick="whitelistCall('(555) 321-9876')" style="background: #4caf50; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Whitelist</button>
                            <button onclick="removeBlocked('(555) 321-9876')" style="background: #8e8e93; color: white; border: none; border-radius: 4px; padding: 4px 8px; font-size: 11px;">Remove</button>
                        </div>
                    </div>
                </div>
                
                <div style="background: #f8f9fa; padding: 12px; border-radius: 8px; margin-top: 12px;">
                    <div style="font-size: 12px; color: #8e8e93; text-align: center;">
                        <span id="selection-hint" style="display: none;">Tap calls to select/deselect ‚Ä¢ </span>
                        <span id="long-press-hint">Press and hold phone number area to select multiple ‚Ä¢ </span>
                        Blocked calls are automatically removed after 30 days
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Contact Detail Screens -->
        <div class="detail-screen" id="john-detail">
            <div class="detail-header">
                <button class="back-arrow" onclick="hideContactDetail()">‚Äπ</button>
                <div class="detail-title">John Smith</div>
            </div>
            
            <div class="detail-card">
                <div style="text-align: center; padding: 16px;">
                    <div class="list-avatar" style="background: #007aff; color: white; font-weight: 600; font-size: 24px; width: 60px; height: 60px; margin: 0 auto 12px;">J</div>
                    <div style="font-size: 18px; font-weight: 600; color: #1c1c1e; margin-bottom: 4px;">John Smith</div>
                    <div style="font-size: 14px; color: #8e8e93;">(555) 123-4567</div>
                </div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Trust Status</div>
                <div style="display: flex; align-items: center; margin-top: 8px;">
                    <span style="color: #4caf50; font-size: 18px; margin-right: 8px;">‚úÖ</span>
                    <span style="color: #4caf50; font-weight: 500;">Trusted Contact</span>
                </div>
                <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Bypasses call screening automatically</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Contact Settings</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üõ°Ô∏è</span>
                        <span class="feature-text">Auto-bypass call screening</span>
                        <span style="color: #4caf50; margin-left: auto;">ON</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üìû</span>
                        <span class="feature-text">Direct call forwarding</span>
                        <span style="color: #4caf50; margin-left: auto;">ON</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üí¨</span>
                        <span class="feature-text">SMS notifications</span>
                        <span style="color: #4caf50; margin-left: auto;">ON</span>
                    </li>
                </ul>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Custom PIN</div>
                <div class="detail-value">Not Set</div>
                <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Optional override PIN for this contact</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Added to Whitelist</div>
                <div class="detail-value">March 15, 2024</div>
            </div>
            
            <div style="padding: 16px;">
                <button style="width: 100%; background: #ff3b30; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 16px; font-weight: 500;">Remove from Trusted Contacts</button>
            </div>
        </div>
        
        <div class="detail-screen" id="mary-detail">
            <div class="detail-header">
                <button class="back-arrow" onclick="hideContactDetail()">‚Äπ</button>
                <div class="detail-title">Mary Johnson</div>
            </div>
            
            <div class="detail-card">
                <div style="text-align: center; padding: 16px;">
                    <div class="list-avatar" style="background: #007aff; color: white; font-weight: 600; font-size: 24px; width: 60px; height: 60px; margin: 0 auto 12px;">M</div>
                    <div style="font-size: 18px; font-weight: 600; color: #1c1c1e; margin-bottom: 4px;">Mary Johnson</div>
                    <div style="font-size: 14px; color: #8e8e93;">(555) 987-6543</div>
                </div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Trust Status</div>
                <div style="display: flex; align-items: center; margin-top: 8px;">
                    <span style="color: #ff9500; font-size: 18px; margin-right: 8px;">‚öôÔ∏è</span>
                    <span style="color: #ff9500; font-weight: 500;">Partial Trust</span>
                </div>
                <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Requires PIN verification to bypass screening</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Contact Settings</div>
                <ul class="feature-list">
                    <li class="feature-item">
                        <span class="feature-icon">üõ°Ô∏è</span>
                        <span class="feature-text">Auto-bypass call screening</span>
                        <span style="color: #8e8e93; margin-left: auto;">OFF</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üìû</span>
                        <span class="feature-text">PIN-based forwarding</span>
                        <span style="color: #4caf50; margin-left: auto;">ON</span>
                    </li>
                    <li class="feature-item">
                        <span class="feature-icon">üí¨</span>
                        <span class="feature-text">SMS notifications</span>
                        <span style="color: #4caf50; margin-left: auto;">ON</span>
                    </li>
                </ul>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Custom PIN</div>
                <div class="detail-value">1234</div>
                <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Required for call screening bypass</div>
            </div>
            
            <div class="detail-card">
                <div class="detail-label">Added to Whitelist</div>
                <div class="detail-value">April 2, 2024</div>
            </div>
            
            <div style="padding: 16px; display: flex; gap: 12px;">
                <button style="flex: 1; background: #4caf50; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 14px; font-weight: 500;">Grant Full Trust</button>
                <button style="flex: 1; background: #ff3b30; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 14px; font-weight: 500;">Remove Contact</button>
            </div>
        </div>
    </div>
    
    <div class="tab-bar">
        <div class="tab active" onclick="switchTab('home'); return false;">
            <div class="tab-icon">üè†</div>
            <div class="tab-label">Home</div>
        </div>
        <div class="tab" onclick="switchTab('dialer'); return false;">
            <div class="tab-icon">üìû</div>
            <div class="tab-label">Dialer</div>
        </div>
        <div class="tab" onclick="switchTab('messages'); return false;">
            <div class="tab-icon">üí¨</div>
            <div class="tab-label">Messages</div>
        </div>
        <div class="tab" onclick="switchTab('history'); return false;">
            <div class="tab-icon">üìã</div>
            <div class="tab-label">History</div>
        </div>
        <div class="tab" onclick="switchTab('contacts'); return false;">
            <div class="tab-icon">üë•</div>
            <div class="tab-label">Contacts</div>
        </div>
        <div class="tab" onclick="switchTab('settings'); return false;">
            <div class="tab-icon">‚öôÔ∏è</div>
            <div class="tab-label">Settings</div>
        </div>
    </div>

    <!-- Custom Modal Overlay -->
    <div id="modal-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div id="modal-content" style="background: white; border-radius: 12px; padding: 24px; margin: 20px; max-width: 320px; text-align: center; box-shadow: 0 4px 20px rgba(0,0,0,0.3);">
            <div id="modal-title" style="font-size: 18px; font-weight: 600; color: #1c1c1e; margin-bottom: 12px;"></div>
            <div id="modal-message" style="font-size: 14px; color: #8e8e93; margin-bottom: 24px; line-height: 1.4;"></div>
            <div id="modal-buttons" style="display: flex; gap: 12px;">
                <!-- Buttons will be inserted here -->
            </div>
        </div>
    </div>

    <script>
        let phoneNumber = '';
        
        const titles = {
            home: 'CallBunker',
            dialer: 'Protected Dialer',
            messages: 'Messages',
            history: 'Call History',
            contacts: 'Trusted Contacts',
            settings: 'Settings'
        };
        
        function switchTab(tab) {
            // Prevent any browser navigation
            event.preventDefault();
            event.stopPropagation();
            
            // Hide all screens and detail screens
            document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.detail-screen').forEach(s => s.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            
            // Show selected screen
            document.getElementById(tab).classList.add('active');
            document.querySelector(`[onclick="switchTab('${tab}')"]`).classList.add('active');
            
            // Update title
            document.getElementById('screen-title').textContent = titles[tab];
            
            return false;
        }
        
        function addDigit(digit) {
            phoneNumber += digit;
            updateDisplay();
        }
        
        function backspace() {
            phoneNumber = phoneNumber.slice(0, -1);
            updateDisplay();
        }
        
        function updateDisplay() {
            const display = document.getElementById('phone-display');
            if (phoneNumber) {
                display.textContent = formatPhone(phoneNumber);
                display.style.color = '#1c1c1e';
            } else {
                display.textContent = 'Enter number';
                display.style.color = '#c7c7cc';
            }
        }
        
        function formatPhone(number) {
            const cleaned = number.replace(/\D/g, '');
            const match = cleaned.match(/^(\d{0,3})(\d{0,3})(\d{0,4})$/);
            if (match) {
                return [match[1], match[2], match[3]].filter(Boolean).join('-');
            }
            return number;
        }
        
        function makeCall() {
            if (phoneNumber) {
                showCustomConfirm(
                    'Protected Call',
                    'Call ' + phoneNumber + '? Your Google Voice number will be shown as caller ID. Your real number stays hidden.',
                    'Call Now',
                    'Cancel',
                    function() {
                        showCustomAlert('Calling...', 'Initiating protected call to ' + phoneNumber);
                    }
                );
            } else {
                showCustomAlert('Enter Number', 'Please enter a phone number to call.');
            }
        }
        
        function showDetail(detailType) {
            // Prevent any browser navigation
            event.preventDefault();
            event.stopPropagation();
            
            // Hide main settings screen
            document.getElementById('settings').classList.remove('active');
            
            // Show detail screen
            document.getElementById(detailType + '-detail').classList.add('active');
            
            // Update header title
            const titles = {
                security: 'Security Settings',
                privacy: 'Privacy Protection', 
                about: 'About CallBunker'
            };
            document.getElementById('screen-title').textContent = titles[detailType];
            
            return false;
        }
        
        function hideDetail() {
            // Hide all detail screens
            document.querySelectorAll('.detail-screen').forEach(s => s.classList.remove('active'));
            
            // Show main settings screen
            document.getElementById('settings').classList.add('active');
            
            // Update header title
            document.getElementById('screen-title').textContent = 'Settings';
        }
        
        function showContactDetail(contactId) {
            // Hide main contacts screen
            document.getElementById('contacts').classList.remove('active');
            
            // Show contact detail screen
            document.getElementById(contactId + '-detail').classList.add('active');
            
            // Update header title
            const titles = {
                john: 'John Smith',
                mary: 'Mary Johnson'
            };
            document.getElementById('screen-title').textContent = titles[contactId];
        }
        
        function hideContactDetail() {
            // Hide all contact detail screens
            document.querySelectorAll('.detail-screen').forEach(s => s.classList.remove('active'));
            
            // Show main contacts screen
            document.getElementById('contacts').classList.add('active');
            
            // Update header title
            document.getElementById('screen-title').textContent = 'Trusted Contacts';
        }
        
        function editPin() {
            document.getElementById('pin-display').style.display = 'none';
            document.getElementById('pin-edit').style.display = 'flex';
            document.getElementById('pin-input').focus();
        }
        
        function savePin() {
            const newPin = document.getElementById('pin-input').value;
            if (newPin && /^\d{4}$/.test(newPin)) {
                document.getElementById('pin-value').textContent = newPin;
                document.getElementById('pin-display').style.display = 'flex';
                document.getElementById('pin-edit').style.display = 'none';
                showCustomAlert('PIN Updated', 'Your new PIN ' + newPin + ' will be used for call authentication.');
                updateSettingsDisplay();
            } else {
                showCustomAlert('Invalid PIN', 'Please enter a valid 4-digit PIN number.');
                document.getElementById('pin-input').focus();
            }
        }
        
        function cancelPinEdit() {
            const currentPin = document.getElementById('pin-value').textContent;
            document.getElementById('pin-input').value = currentPin;
            document.getElementById('pin-display').style.display = 'flex';
            document.getElementById('pin-edit').style.display = 'none';
        }
        
        function editVerbal() {
            document.getElementById('verbal-display').style.display = 'none';
            document.getElementById('verbal-edit').style.display = 'flex';
            document.getElementById('verbal-input').focus();
        }
        
        function saveVerbal() {
            const newVerbal = document.getElementById('verbal-input').value.trim();
            if (newVerbal && newVerbal.length >= 3) {
                document.getElementById('verbal-value').textContent = '"' + newVerbal + '"';
                document.getElementById('verbal-display').style.display = 'flex';
                document.getElementById('verbal-edit').style.display = 'none';
                showCustomAlert('Verbal Code Updated', 'Your new code "' + newVerbal + '" will be used for voice authentication.');
                updateSettingsDisplay();
            } else {
                showCustomAlert('Invalid Code', 'Please enter a verbal code with at least 3 characters.');
                document.getElementById('verbal-input').focus();
            }
        }
        
        function cancelVerbalEdit() {
            const currentVerbal = document.getElementById('verbal-value').textContent.replace(/"/g, '');
            document.getElementById('verbal-input').value = currentVerbal;
            document.getElementById('verbal-display').style.display = 'flex';
            document.getElementById('verbal-edit').style.display = 'none';
        }
        
        function updateSettingsDisplay() {
            // Update the PIN and verbal code display in the main settings list
            const pin = document.getElementById('pin-value').textContent;
            const verbal = document.getElementById('verbal-value').textContent.replace(/"/g, '');
            
            // Find and update the settings subtitle
            const settingsItems = document.querySelectorAll('#settings .list-subtitle');
            settingsItems.forEach(item => {
                if (item.textContent.includes('PIN:')) {
                    item.textContent = `PIN: ${pin}, Verbal: "${verbal}"`;
                }
            });
        }
        
        function showAnalytics() {
            // Prevent any browser navigation
            event.preventDefault();
            event.stopPropagation();
            
            // Hide main home screen
            document.getElementById('home').classList.remove('active');
            
            // Show analytics detail screen
            document.getElementById('analytics-detail').classList.add('active');
            
            // Update header title
            document.getElementById('screen-title').textContent = 'Security Analytics';
            
            return false;
        }
        
        function hideAnalytics() {
            // Hide analytics detail screen
            document.getElementById('analytics-detail').classList.remove('active');
            
            // Show main home screen
            document.getElementById('home').classList.add('active');
            
            // Update header title
            document.getElementById('screen-title').textContent = 'CallBunker';
        }
        
        function whitelistCall(phoneNumber) {
            showCustomConfirm(
                'Add to Trusted Contacts?',
                phoneNumber + ' will bypass call screening in future calls.',
                'Add to Trusted',
                'Cancel',
                function() {
                    // Remove from blocked list
                    removeBlockedCallFromList(phoneNumber);
                    updateBlockedCallsCount();
                    
                    // Add to trusted contacts list
                    addToTrustedContacts(phoneNumber);
                    
                    showCustomAlert('Success!', phoneNumber + ' has been added to your trusted contacts.');
                }
            );
        }
        
        function addToTrustedContacts(phoneNumber) {
            const contactsScreen = document.getElementById('contacts');
            
            // Create new contact item
            const newContact = document.createElement('div');
            newContact.className = 'list-item';
            newContact.style.cursor = 'pointer';
            
            // Generate a unique contact ID based on phone number
            const contactId = 'contact_' + phoneNumber.replace(/[^0-9]/g, '');
            
            // Get first letter for avatar
            const firstLetter = phoneNumber.replace(/[^A-Za-z0-9]/g, '')[0] || '?';
            
            newContact.innerHTML = `
                <div class="list-avatar" style="background: #007aff; color: white; font-weight: 600;">${firstLetter.toUpperCase()}</div>
                <div class="list-content">
                    <div class="list-title">${phoneNumber}</div>
                    <div class="list-subtitle">Added from blocked list</div>
                </div>
                <div style="color: #4caf50;">‚úÖ</div>
            `;
            
            // Add click handler to show contact detail
            newContact.onclick = function() {
                showDynamicContactDetail(phoneNumber, contactId);
            };
            
            // Insert after the info banner but before existing contacts
            const infoBanner = contactsScreen.querySelector('div[style*="background: #e8f5e8"]');
            if (infoBanner && infoBanner.nextElementSibling) {
                contactsScreen.insertBefore(newContact, infoBanner.nextElementSibling);
            } else {
                contactsScreen.appendChild(newContact);
            }
            
            // Update trusted contacts count
            updateTrustedContactsCount();
        }
        
        function showDynamicContactDetail(phoneNumber, contactId) {
            // Hide main contacts screen
            document.getElementById('contacts').classList.remove('active');
            
            // Create or update dynamic contact detail screen
            let detailScreen = document.getElementById(contactId + '-detail');
            if (!detailScreen) {
                detailScreen = createContactDetailScreen(phoneNumber, contactId);
                document.querySelector('.content').appendChild(detailScreen);
            }
            
            // Show the detail screen
            detailScreen.classList.add('active');
            
            // Update header title
            document.getElementById('screen-title').textContent = phoneNumber;
        }
        
        function createContactDetailScreen(phoneNumber, contactId) {
            const detailScreen = document.createElement('div');
            detailScreen.className = 'detail-screen';
            detailScreen.id = contactId + '-detail';
            
            detailScreen.innerHTML = `
                <div class="detail-header">
                    <button class="back-arrow" onclick="hideDynamicContactDetail('${contactId}')">‚Äπ</button>
                    <div class="detail-title">${phoneNumber}</div>
                </div>
                
                <div class="detail-card">
                    <div class="detail-label">Phone Number</div>
                    <div class="detail-value">${phoneNumber}</div>
                    <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Primary contact number</div>
                </div>
                
                <div class="detail-card">
                    <div class="detail-label">Trust Level</div>
                    <div class="detail-value">Trusted Contact</div>
                    <div style="font-size: 12px; color: #8e8e93; margin-top: 4px;">Bypasses call screening automatically</div>
                </div>
                
                <div class="detail-card">
                    <div class="detail-label">Added to Whitelist</div>
                    <div class="detail-value">${new Date().toLocaleDateString()}</div>
                </div>
                
                <div style="padding: 16px; display: flex; gap: 12px;">
                    <button onclick="editContactPin('${phoneNumber}')" style="flex: 1; background: #007aff; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 14px; font-weight: 500;">Set Custom PIN</button>
                    <button onclick="removeFromTrustedContacts('${phoneNumber}', '${contactId}')" style="flex: 1; background: #ff3b30; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 14px; font-weight: 500;">Remove Contact</button>
                </div>
            `;
            
            return detailScreen;
        }
        
        function hideDynamicContactDetail(contactId) {
            // Hide the contact detail screen
            document.getElementById(contactId + '-detail').classList.remove('active');
            
            // Show main contacts screen
            document.getElementById('contacts').classList.add('active');
            
            // Update header title
            document.getElementById('screen-title').textContent = 'Trusted Contacts';
        }
        
        function editContactPin(phoneNumber) {
            showCustomAlert('Feature Coming Soon', 'Custom PIN assignment for individual contacts will be available in a future update.');
        }
        
        function removeFromTrustedContacts(phoneNumber, contactId) {
            showCustomConfirm(
                'Remove from Trusted Contacts?',
                phoneNumber + ' will no longer bypass call screening.',
                'Remove',
                'Cancel',
                function() {
                    // Remove the contact from the list
                    const contactElement = document.querySelector(`[onclick*="${contactId}"]`);
                    if (contactElement) {
                        contactElement.remove();
                    }
                    
                    // Remove the detail screen
                    const detailScreen = document.getElementById(contactId + '-detail');
                    if (detailScreen) {
                        detailScreen.remove();
                    }
                    
                    // Update trusted contacts count
                    updateTrustedContactsCount();
                    
                    // Return to contacts screen
                    document.getElementById('contacts').classList.add('active');
                    document.getElementById('screen-title').textContent = 'Trusted Contacts';
                    
                    showCustomAlert('Removed', phoneNumber + ' has been removed from your trusted contacts.');
                }
            );
        }
        
        function removeBlocked(phoneNumber) {
            showCustomConfirm(
                'Remove from Blocked List?',
                'This will delete the block record for ' + phoneNumber,
                'Remove',
                'Cancel',
                function() {
                    removeBlockedCallFromList(phoneNumber);
                    updateBlockedCallsCount();
                    showCustomAlert('Removed', 'Blocked call has been removed from the list.');
                }
            );
        }
        
        function removeBlockedCallFromList(phoneNumber) {
            // Find and remove the blocked call item using data-phone attribute
            const item = document.querySelector(`[data-phone="${phoneNumber}"]`);
            if (item) {
                item.remove();
            }
        }
        
        function clearAllBlocked() {
            showCustomConfirm(
                'Clear All Blocked Calls?',
                'This will remove all blocked calls from your list. This action cannot be undone.',
                'Clear All',
                'Cancel',
                function() {
                    const blockedList = document.getElementById('blocked-calls-list');
                    blockedList.innerHTML = '<div style="text-align: center; padding: 20px; color: #8e8e93; font-size: 14px;">No blocked calls</div>';
                    
                    const headerLabel = document.querySelector('#analytics-detail .detail-label');
                    if (headerLabel && headerLabel.textContent.includes('Blocked Calls')) {
                        headerLabel.textContent = 'Blocked Calls (0)';
                    }
                    
                    showCustomAlert('Cleared', 'All blocked calls have been removed.');
                }
            );
        }
        
        function updateBlockedCallsCount() {
            // Count remaining blocked call items
            const remainingItems = document.querySelectorAll('.blocked-call-item').length;
            
            // Update the analytics detail header
            const detailLabels = document.querySelectorAll('.detail-label');
            detailLabels.forEach(label => {
                if (label.textContent.includes('Blocked Calls')) {
                    label.textContent = `Blocked Calls (${remainingItems})`;
                }
            });
            
            // Update the home screen stat
            const homeStatElement = document.getElementById('blocked-calls-stat');
            if (homeStatElement) {
                homeStatElement.textContent = remainingItems;
            }
            
            // If no items left, show empty state
            if (remainingItems === 0) {
                const blockedList = document.getElementById('blocked-calls-list');
                if (blockedList) {
                    blockedList.innerHTML = '<div style="text-align: center; padding: 20px; color: #8e8e93; font-size: 14px;">No blocked calls</div>';
                }
            }
        }
        
        function updateTrustedContactsCount() {
            // Count all list items in the contacts screen except the info banner
            const contactsScreen = document.getElementById('contacts');
            if (!contactsScreen) return;
            
            const allItems = contactsScreen.querySelectorAll('.list-item');
            const totalContacts = allItems.length;
            
            // Update the home screen stat
            const trustedStatElement = document.getElementById('trusted-contacts-stat');
            if (trustedStatElement) {
                trustedStatElement.textContent = totalContacts;
            }
        }
        
        // Custom modal functions
        function showCustomAlert(title, message) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('modal-buttons').innerHTML = `
                <button onclick="hideModal()" style="flex: 1; background: #007aff; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 16px; font-weight: 500;">OK</button>
            `;
            document.getElementById('modal-overlay').style.display = 'flex';
        }
        
        function showCustomConfirm(title, message, confirmText, cancelText, onConfirm) {
            document.getElementById('modal-title').textContent = title;
            document.getElementById('modal-message').textContent = message;
            document.getElementById('modal-buttons').innerHTML = `
                <button onclick="hideModal()" style="flex: 1; background: #8e8e93; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 16px; font-weight: 500;">${cancelText}</button>
                <button onclick="confirmAction()" style="flex: 1; background: #007aff; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 16px; font-weight: 500;">${confirmText}</button>
            `;
            document.getElementById('modal-overlay').style.display = 'flex';
            window.currentConfirmAction = onConfirm;
        }
        
        function hideModal() {
            document.getElementById('modal-overlay').style.display = 'none';
            window.currentConfirmAction = null;
        }
        
        function confirmAction() {
            if (window.currentConfirmAction) {
                window.currentConfirmAction();
            }
            hideModal();
        }
        
        // Close modal when clicking overlay
        document.getElementById('modal-overlay').onclick = function(e) {
            if (e.target === this) {
                hideModal();
            }
        }
        
        // Multi-select functionality for blocked calls
        let isSelectionMode = false;
        let selectedCalls = new Set();
        let longPressTimeout;
        let longPressStartX, longPressStartY;
        
        // Initialize long press handlers for blocked call items
        function initializeLongPress() {
            document.querySelectorAll('.blocked-call-item').forEach(item => {
                let longPressTriggered = false;
                
                // Only add long press to the main content area, not buttons
                const contentArea = item.querySelector('.list-content');
                if (!contentArea) return;
                
                contentArea.addEventListener('touchstart', function(e) {
                    if (isSelectionMode) return;
                    
                    // Don't trigger on buttons
                    if (e.target.tagName === 'BUTTON') return;
                    
                    longPressTriggered = false;
                    const touch = e.touches[0];
                    longPressStartX = touch.clientX;
                    longPressStartY = touch.clientY;
                    
                    longPressTimeout = setTimeout(() => {
                        longPressTriggered = true;
                        // Add stronger vibration feedback if available
                        if (navigator.vibrate) {
                            navigator.vibrate([50, 25, 50]); // Double vibration pattern
                        }
                        enterSelectionMode();
                        toggleItemSelection(item);
                    }, 700); // Reduced to 700ms for more responsive feel
                });
                
                contentArea.addEventListener('touchmove', function(e) {
                    if (!longPressTimeout) return;
                    
                    const touch = e.touches[0];
                    const moveX = Math.abs(touch.clientX - longPressStartX);
                    const moveY = Math.abs(touch.clientY - longPressStartY);
                    
                    // Cancel if moved more than 15px in any direction
                    if (moveX > 15 || moveY > 15) {
                        clearTimeout(longPressTimeout);
                        longPressTimeout = null;
                    }
                });
                
                contentArea.addEventListener('touchend', function(e) {
                    // Only cancel timeout if long press hasn't triggered yet
                    if (longPressTimeout && !longPressTriggered) {
                        clearTimeout(longPressTimeout);
                        longPressTimeout = null;
                    }
                    
                    // Handle selection ONLY if already in selection mode AND it was a quick tap (not the initial long press)
                    // AND the tap was not on a button
                    if (isSelectionMode && !longPressTriggered && e.target.tagName !== 'BUTTON') {
                        e.preventDefault();
                        e.stopPropagation();
                        toggleItemSelection(item);
                    }
                    
                    // Reset flag after a brief delay to allow the long press action to complete
                    setTimeout(() => {
                        longPressTriggered = false;
                    }, 50);
                });
                
                // Add click handler for selection mode only (not for entering selection mode)
                item.addEventListener('click', function(e) {
                    // Only allow normal button clicks when NOT in selection mode
                    if (!isSelectionMode) {
                        // Allow normal button clicks to work (whitelist/remove)
                        return;
                    }
                    
                    // In selection mode: only handle clicks on content area, not buttons
                    if (e.target.tagName !== 'BUTTON' && e.target.closest('.item-actions') === null) {
                        e.preventDefault();
                        e.stopPropagation();
                        toggleItemSelection(item);
                    }
                });
            });
        }
        
        function enterSelectionMode() {
            isSelectionMode = true;
            selectedCalls.clear();
            
            // Show checkboxes and hide individual action buttons
            document.querySelectorAll('.blocked-call-item').forEach(item => {
                item.querySelector('.selection-checkbox').style.display = 'block';
                item.querySelector('.item-actions').style.display = 'none';
                item.style.backgroundColor = '#f8f9fa';
                item.style.cursor = 'pointer';
            });
            
            // Switch header actions
            document.getElementById('blocked-actions').style.display = 'none';
            document.getElementById('selection-actions').style.display = 'flex';
            document.getElementById('selection-hint').style.display = 'inline';
            document.getElementById('long-press-hint').style.display = 'none';
            
            updateSelectionCount();
        }
        
        function exitSelectionMode() {
            isSelectionMode = false;
            selectedCalls.clear();
            
            // Hide checkboxes and show individual action buttons
            document.querySelectorAll('.blocked-call-item').forEach(item => {
                item.querySelector('.selection-checkbox').style.display = 'none';
                item.querySelector('.item-actions').style.display = 'flex';
                item.style.backgroundColor = 'transparent';
                item.style.cursor = 'default';
                
                const checkbox = item.querySelector('.selection-checkbox');
                const checkmark = checkbox.querySelector('.checkmark');
                checkbox.style.backgroundColor = 'transparent';
                checkmark.style.display = 'none';
            });
            
            // Switch header actions back
            document.getElementById('blocked-actions').style.display = 'block';
            document.getElementById('selection-actions').style.display = 'none';
            document.getElementById('selection-hint').style.display = 'none';
            document.getElementById('long-press-hint').style.display = 'inline';
        }
        
        function toggleItemSelection(item) {
            const phoneNumber = item.dataset.phone;
            const checkbox = item.querySelector('.selection-checkbox');
            const checkmark = checkbox.querySelector('.checkmark');
            
            if (selectedCalls.has(phoneNumber)) {
                selectedCalls.delete(phoneNumber);
                checkbox.style.backgroundColor = 'transparent';
                checkmark.style.display = 'none';
            } else {
                selectedCalls.add(phoneNumber);
                checkbox.style.backgroundColor = '#007aff';
                checkmark.style.display = 'block';
            }
            
            updateSelectionCount();
        }
        
        function updateSelectionCount() {
            const count = selectedCalls.size;
            document.getElementById('selection-count').textContent = `${count} selected`;
            
            // Disable both buttons when no items selected
            const removeBtn = document.querySelector('#selection-actions button[onclick="removeSelected()"]');
            const whitelistBtn = document.querySelector('#selection-actions button[onclick="whitelistSelected()"]');
            
            if (removeBtn) removeBtn.disabled = count === 0;
            if (whitelistBtn) whitelistBtn.disabled = count === 0;
        }
        
        function cancelSelection() {
            exitSelectionMode();
        }
        
        function removeSelected() {
            const count = selectedCalls.size;
            if (count === 0) return;
            
            showCustomConfirm(
                `Remove ${count} Selected Call${count > 1 ? 's' : ''}?`,
                `This will remove ${count} blocked call${count > 1 ? 's' : ''} from your list.`,
                `Remove ${count}`,
                'Cancel',
                function() {
                    selectedCalls.forEach(phoneNumber => {
                        removeBlockedCallFromList(phoneNumber);
                    });
                    exitSelectionMode();
                    updateBlockedCallsCount();
                    showCustomAlert('Removed', `${count} blocked call${count > 1 ? 's have' : ' has'} been removed.`);
                }
            );
        }
        
        function whitelistSelected() {
            const count = selectedCalls.size;
            if (count === 0) return;
            
            showCustomConfirm(
                `Add ${count} Selected Call${count > 1 ? 's' : ''} to Trusted Contacts?`,
                `${count} contact${count > 1 ? 's' : ''} will bypass call screening in future calls.`,
                `Add ${count} to Trusted`,
                'Cancel',
                function() {
                    selectedCalls.forEach(phoneNumber => {
                        // Remove from blocked list
                        removeBlockedCallFromList(phoneNumber);
                        // Add to trusted contacts
                        addToTrustedContacts(phoneNumber);
                    });
                    exitSelectionMode();
                    updateBlockedCallsCount();
                    showCustomAlert('Success!', `${count} contact${count > 1 ? 's have' : ' has'} been added to your trusted contacts.`);
                }
            );
        }
        

        
        // Initialize long press when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeLongPress();
        });
        
        // Re-initialize when navigating to analytics
        const originalShowAnalytics = showAnalytics;
        showAnalytics = function() {
            originalShowAnalytics();
            setTimeout(() => {
                initializeLongPress();
                // Also prevent default click behavior on blocked call items in selection mode
                document.querySelectorAll('.blocked-call-item').forEach(item => {
                    // Remove any existing onclick handlers that might interfere
                    item.onclick = function(e) {
                        if (isSelectionMode) {
                            e.preventDefault();
                            e.stopPropagation();
                            toggleItemSelection(item);
                            return false;
                        }
                    };
                });
            }, 100);
        };
    </script>
</body>
</html>