<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CallBunker Mobile App Demo</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .mobile-frame {
            width: 375px;
            height: 812px;
            background: #F8F9FA;
            border-radius: 40px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            position: relative;
            overflow: hidden;
            border: 8px solid #1C1C1E;
        }
        
        .status-bar {
            height: 44px;
            background: #F8F9FA;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 20px;
            font-size: 14px;
            font-weight: 600;
            color: #1C1C1E;
        }
        
        .demo-banner {
            background: linear-gradient(135deg, #4CAF50, #45a049);
            color: white;
            padding: 8px;
            text-align: center;
            font-weight: 600;
            font-size: 12px;
        }
        
        .app-container {
            height: calc(100% - 52px);
            position: relative;
        }
        
        .screen {
            display: none;
            padding: 20px 16px 100px 16px;
            height: 100%;
            overflow-y: auto;
        }
        
        .screen.active {
            display: block;
        }
        
        /* Home Screen */
        .status-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .status-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }
        
        .status-icon {
            width: 40px;
            height: 40px;
            background: #4CAF50;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 20px;
            color: white;
        }
        
        .status-text h3 {
            font-size: 18px;
            font-weight: 600;
            color: #1C1C1E;
            margin: 0 0 2px 0;
        }
        
        .status-text p {
            font-size: 14px;
            color: #8E8E93;
            margin: 0;
        }
        
        .stats-container {
            display: flex;
            background: #F8F9FA;
            border-radius: 12px;
            padding: 16px;
        }
        
        .stat-item {
            flex: 1;
            text-align: center;
        }
        
        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: #007AFF;
            margin: 0;
        }
        
        .stat-label {
            font-size: 12px;
            color: #8E8E93;
            margin: 4px 0 0 0;
        }
        
        .privacy-protected-card {
            background: #F8F9FA;
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .main-action-card {
            background: #F5F5F7;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s ease;
        }
        
        .main-action-card:hover {
            transform: translateY(-2px);
        }
        
        .stat-divider {
            width: 1px;
            background: #E5E5EA;
            margin: 0 16px;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #1C1C1E;
            margin: 0 0 16px 0;
        }
        
        .action-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .action-card {
            background: white;
            border-radius: 16px;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .action-card:active {
            transform: scale(0.96);
        }
        
        .action-icon {
            font-size: 28px;
            margin-bottom: 8px;
            display: block;
        }
        
        .action-title {
            font-size: 14px;
            font-weight: 600;
            color: #1C1C1E;
            margin: 0 0 4px 0;
        }
        
        .action-subtitle {
            font-size: 12px;
            color: #8E8E93;
            margin: 0;
        }
        
        /* Dialer Screen */
        .phone-display {
            background: white;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            font-size: 32px;
            font-weight: 300;
            margin-bottom: 24px;
            min-height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: #1C1C1E;
            letter-spacing: 2px;
        }
        
        .dialer-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 32px;
            padding: 0 20px;
        }
        
        .dial-btn {
            background: white;
            border: none;
            border-radius: 50%;
            width: 75px;
            height: 75px;
            font-size: 32px;
            font-weight: 300;
            cursor: pointer;
            transition: all 0.15s;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            color: #1C1C1E;
        }
        
        .dial-btn:active {
            background: #E5E5EA;
            transform: scale(0.95);
        }
        
        .call-actions {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 24px;
        }
        
        .call-button {
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 50%;
            width: 70px;
            height: 70px;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(76, 175, 80, 0.3);
        }
        
        .action-button {
            background: #8E8E93;
            color: white;
            border: none;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            font-size: 18px;
            cursor: pointer;
        }
        
        .features-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 20px;
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
        }
        
        .feature-item {
            text-align: center;
            padding: 8px;
        }
        
        .feature-icon {
            font-size: 18px;
            margin-bottom: 4px;
            color: #4CAF50;
        }
        
        .feature-text {
            font-size: 11px;
            color: #8E8E93;
            font-weight: 500;
        }
        
        /* Settings Screen */
        .settings-section {
            background: white;
            border-radius: 16px;
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .settings-section h3 {
            font-size: 13px;
            font-weight: 600;
            color: #8E8E93;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin: 0 0 16px 0;
            padding: 0 4px;
        }
        
        .setting-item {
            display: flex;
            align-items: center;
            padding: 16px;
            border-bottom: 1px solid #F2F2F7;
            cursor: pointer;
        }
        
        .setting-item:last-child {
            border-bottom: none;
        }
        
        .setting-icon {
            width: 32px;
            height: 32px;
            background: #F0F9FF;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 12px;
            font-size: 16px;
            color: #007AFF;
        }
        
        .setting-content {
            flex: 1;
        }
        
        .setting-title {
            font-size: 16px;
            font-weight: 500;
            color: #1C1C1E;
            margin: 0 0 2px 0;
        }
        
        .setting-subtitle {
            font-size: 13px;
            color: #8E8E93;
            margin: 0;
        }
        
        .setting-toggle {
            width: 50px;
            height: 30px;
            background: #E5E5EA;
            border-radius: 15px;
            position: relative;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .setting-toggle.active {
            background: #007AFF;
        }
        
        .toggle-handle {
            width: 26px;
            height: 26px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 2px;
            left: 2px;
            transition: transform 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .setting-toggle.active .toggle-handle {
            transform: translateX(20px);
        }
        
        /* Bottom Tab Navigation */
        .tab-navigation {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            border-top: 1px solid #E5E5EA;
            display: flex;
            padding: 8px 0 24px 0;
            height: 88px;
        }
        
        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            padding: 4px;
            text-align: center;
            font-size: 10px;
            cursor: pointer;
            transition: all 0.2s;
            color: #8E8E93;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        .tab-btn.active {
            color: #007AFF;
        }
        
        .tab-icon {
            font-size: 22px;
            margin-bottom: 2px;
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 16px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #1C1C1E;
            font-size: 16px;
        }
        
        .form-input {
            width: 100%;
            padding: 16px;
            border: 1px solid #E5E5EA;
            border-radius: 12px;
            font-size: 16px;
            background: white;
            transition: border-color 0.3s;
        }
        
        .form-input:focus {
            outline: none;
            border-color: #007AFF;
        }
        
        .btn {
            background: #007AFF;
            color: white;
            border: none;
            padding: 16px 20px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin: 12px 0;
            transition: background 0.3s;
        }
        
        .btn:active {
            background: #0056CC;
        }
        
        .info-card {
            background: white;
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
            border-left: 4px solid #007AFF;
        }
        
        .success-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }
        
        .success-modal.active {
            display: flex;
        }
        
        .modal-content {
            background: white;
            border-radius: 20px;
            padding: 32px 24px;
            max-width: 300px;
            text-align: center;
            margin: 20px;
        }
        
        .modal-icon {
            font-size: 64px;
            color: #4CAF50;
            margin-bottom: 16px;
        }
        
        .modal-title {
            font-size: 24px;
            font-weight: 600;
            color: #1C1C1E;
            margin: 0 0 8px 0;
        }
        
        .modal-text {
            font-size: 16px;
            color: #8E8E93;
            line-height: 1.4;
            margin: 0 0 24px 0;
        }
        
        .defense-number {
            font-size: 20px;
            font-weight: 600;
            color: #007AFF;
            background: #F0F9FF;
            padding: 12px;
            border-radius: 8px;
            margin: 16px 0;
        }
    </style>
</head>
<body>
    <div class="mobile-frame">
        <div class="status-bar">
            <span>9:41</span>
            <span>☁️ 5G 📶 🔋</span>
        </div>
        
        <div class="demo-banner">
            🚀 CallBunker Mobile App - Live Backend Integration Demo
        </div>
        
        <div class="app-container">
            <!-- Signup Screen -->
            <div class="screen active" id="signup-screen">
                <h2 style="text-align: center; margin-bottom: 8px; font-size: 28px; font-weight: 700; color: #1C1C1E;">Join CallBunker</h2>
                <p style="text-align: center; margin-bottom: 32px; color: #8E8E93; font-size: 16px;">The last line of defense against spam calls</p>
                
                <div id="signup-status"></div>
                
                <form id="signup-form">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" id="name" class="form-input" placeholder="Enter your name" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" id="email" class="form-input" placeholder="your@email.com" required>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Google Voice Number</label>
                        <div style="display: flex; gap: 8px; align-items: center;">
                            <input type="tel" id="google_voice" class="form-input" placeholder="(555) 123-4567" required style="flex: 1;">
                            <button type="button" onclick="window.open('https://voice.google.com', '_blank')" 
                                    style="background: #34a853; color: white; border: none; padding: 16px 12px; border-radius: 12px; cursor: pointer; font-size: 12px; font-weight: 600; white-space: nowrap;">
                                Get Voice
                            </button>
                        </div>
                        <div style="font-size: 13px; color: #8E8E93; margin-top: 8px;">
                            Need a number? Tap "Get Voice" for a free Google Voice number
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Real Phone Number</label>
                        <input type="tel" id="real_phone" class="form-input" placeholder="(555) 987-6543" required>
                        <div style="font-size: 13px; color: #8E8E93; margin-top: 8px;">
                            Where calls should be forwarded after screening
                        </div>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                        <div class="form-group">
                            <label class="form-label">PIN</label>
                            <input type="text" id="pin" class="form-input" placeholder="1234" maxlength="4" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">Verbal Code</label>
                            <input type="text" id="verbal_code" class="form-input" placeholder="open sesame" required>
                        </div>
                    </div>
                    
                    <button type="submit" class="btn">🚀 Create Account</button>
                </form>
                
            </div>

            <!-- Home Screen -->
            <div class="screen" id="home-screen">
                <h1 style="text-align: center; font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 30px;">CallBunker</h1>
                
                <div class="privacy-protected-card">
                    <div style="display: flex; align-items: center; margin-bottom: 16px;">
                        <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🛡️</div>
                        <span style="font-size: 16px; color: #4CAF50; font-weight: 500;">Privacy Protected</span>
                    </div>
                    <p style="font-size: 14px; color: #8E8E93; margin: 0 0 16px 0;">Your real number is hidden • Tap for details</p>
                    
                    <div style="display: flex; justify-content: space-around; background: white; border-radius: 12px; padding: 0; box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: relative; overflow: hidden;">
                        <div style="text-align: center; cursor: pointer; padding: 20px; flex: 1;" onclick="showScreen('history-screen')">
                            <div style="font-size: 28px; font-weight: 700; color: #FF3B30; margin-bottom: 4px;" id="blocked-calls">6</div>
                            <div style="font-size: 14px; color: #8E8E93;">Blocked Calls</div>
                        </div>
                        <div style="position: absolute; left: 50%; top: 0; bottom: 0; width: 1px; background: #E5E5EA;"></div>
                        <div style="text-align: center; cursor: pointer; padding: 20px; flex: 1; background: #F8F9FA;" onclick="showScreen('contacts-screen')">
                            <div style="font-size: 28px; font-weight: 700; color: #4CAF50; margin-bottom: 4px;" id="trusted-contacts">2</div>
                            <div style="font-size: 14px; color: #8E8E93;">Trusted Contacts</div>
                        </div>
                    </div>
                </div>


            </div>

            <!-- Dialer Screen -->
            <div class="screen" id="dialer-screen">
                <h1 style="text-align: center; font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 40px;">Protected Dialer</h1>
                
                <div class="phone-display" id="phone-display" style="font-size: 32px; font-weight: 300; text-align: center; color: #1C1C1E; margin-bottom: 16px; min-height: 40px; word-wrap: break-word; overflow-wrap: break-word; line-height: 1.2; max-width: 100%; padding: 0 20px;">Enter number</div>
                
                <div style="text-align: center; margin-bottom: 40px;">
                    <span style="color: #4CAF50; font-size: 14px; font-weight: 500;">🛡️ Privacy Protected</span>
                    <span style="color: #8E8E93; font-size: 14px; margin: 0 8px;">•</span>
                    <span style="color: #007AFF; font-size: 14px; font-weight: 500;">🔊 Touch Tones</span>
                </div>
                
                <div class="dialer-grid" style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 16px; margin-bottom: 40px;">
                    <button class="dial-btn" onclick="playTone('1'); addDigit('1')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>1</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('2'); addDigit('2')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>2</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">ABC</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('3'); addDigit('3')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>3</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">DEF</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('4'); addDigit('4')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>4</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">GHI</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('5'); addDigit('5')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>5</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">JKL</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('6'); addDigit('6')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>6</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">MNO</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('7'); addDigit('7')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>7</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">PQRS</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('8'); addDigit('8')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>8</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">TUV</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('9'); addDigit('9')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <span>9</span>
                        <span style="font-size: 10px; margin-top: 2px; color: #8E8E93;">WXYZ</span>
                    </button>
                    <button class="dial-btn" onclick="playTone('*'); addDigit('*')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; align-items: center; justify-content: center;">*</button>
                    <button class="dial-btn" onclick="playTone('0'); addDigit('0')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; align-items: center; justify-content: center;">0</button>
                    <button class="dial-btn" onclick="playTone('#'); addDigit('#')" style="width: 70px; height: 70px; border-radius: 35px; border: none; background: #F8F9FA; font-size: 24px; font-weight: 400; color: #1C1C1E; margin: 0 auto; display: flex; align-items: center; justify-content: center;">#</button>
                </div>
                
                <div style="display: flex; justify-content: center; align-items: center; gap: 60px;">
                    <button onclick="clearNumber()" style="width: 50px; height: 50px; border-radius: 25px; border: none; background: #FF3B30; color: white; font-size: 18px; display: flex; align-items: center; justify-content: center;">⌫</button>
                    <button onclick="makeCall()" style="width: 64px; height: 64px; border-radius: 32px; border: none; background: #4CAF50; color: white; font-size: 24px; display: flex; align-items: center; justify-content: center;">📞</button>
                    <div style="width: 50px;"></div>
                </div>
                
                <div id="call-status"></div>
            </div>

            <!-- Security Analytics Screen -->
            <div class="screen" id="history-screen">
                <h1 style="text-align: center; font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 30px;">Security Analytics</h1>
                
                <div style="background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; align-items: center; margin-bottom: 16px;">
                        <div style="width: 48px; height: 48px; background: #007AFF; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 16px; font-size: 24px; color: white;">🛡️</div>
                        <div>
                            <div style="font-size: 18px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">Privacy Protection Active</div>
                            <div style="font-size: 14px; color: #8E8E93;">Your real number stays completely hidden</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 16px;">CALL STATISTICS (LAST 30 DAYS)</h3>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: 700; color: #4CAF50; margin-bottom: 4px;">14</div>
                            <div style="font-size: 14px; color: #8E8E93;">Protected Calls</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: 700; color: #007AFF; margin-bottom: 4px;">20</div>
                            <div style="font-size: 14px; color: #8E8E93;">Total Calls</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: 700; color: #FF9500; margin-bottom: 4px;">12</div>
                            <div style="font-size: 14px; color: #8E8E93;">Screened Calls</div>
                        </div>
                        <div style="text-align: center;">
                            <div style="font-size: 32px; font-weight: 700; color: #FF3B30; margin-bottom: 4px;">6</div>
                            <div style="font-size: 14px; color: #8E8E93;">Blocked Attempts</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 16px;">PROTECTION EFFECTIVENESS</h3>
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-size: 16px; color: #1C1C1E;">Privacy Success Rate</span>
                            <span style="font-size: 16px; font-weight: 600; color: #4CAF50;">70%</span>
                        </div>
                        <div style="width: 100%; height: 6px; background: #E5E5EA; border-radius: 3px; overflow: hidden;">
                            <div style="width: 70%; height: 100%; background: #4CAF50; border-radius: 3px;"></div>
                        </div>
                    </div>
                    <div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span style="font-size: 16px; color: #1C1C1E;">Authentication Rate</span>
                            <span style="font-size: 16px; font-weight: 600; color: #4CAF50;">71%</span>
                        </div>
                        <div style="width: 100%; height: 6px; background: #E5E5EA; border-radius: 3px; overflow: hidden;">
                            <div style="width: 71%; height: 100%; background: #4CAF50; border-radius: 3px;"></div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 16px;">RECENT ACTIVITY</h3>
                    <div style="margin-bottom: 12px; display: flex; align-items: center;">
                        <div style="width: 24px; height: 24px; background: #FF3B30; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🚫</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; color: #1C1C1E;">Blocked call from (555) 999-8888</div>
                            <div style="font-size: 14px; color: #8E8E93;">2 hours ago</div>
                        </div>
                    </div>
                    <div style="margin-bottom: 12px; display: flex; align-items: center;">
                        <div style="width: 24px; height: 24px; background: #FF3B30; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🚫</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; color: #1C1C1E;">Blocked call from (555) 123-0000</div>
                            <div style="font-size: 14px; color: #8E8E93;">4 hours ago</div>
                        </div>
                    </div>
                    <div style="margin-bottom: 12px; display: flex; align-items: center;">
                        <div style="width: 24px; height: 24px; background: #FF3B30; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🚫</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; color: #1C1C1E;">Blocked call from (555) 777-4444</div>
                            <div style="font-size: 14px; color: #8E8E93;">6 hours ago</div>
                        </div>
                    </div>
                    <div style="margin-bottom: 12px; display: flex; align-items: center;">
                        <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">✓</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; color: #1C1C1E;">Trusted contact bypassed screening</div>
                            <div style="font-size: 14px; color: #8E8E93;">6 hours ago</div>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center;">
                        <div style="width: 24px; height: 24px; background: #007AFF; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🛡️</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; color: #1C1C1E;">Call screening: PIN verified</div>
                            <div style="font-size: 14px; color: #8E8E93;">8 hours ago</div>
                        </div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 16px;">SECURITY FEATURES ACTIVE</h3>
                    <div style="margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 18px; margin-right: 12px;">🔢</div>
                            <span style="font-size: 16px; color: #1C1C1E;">PIN Authentication</span>
                        </div>
                        <div style="color: #4CAF50; font-size: 18px;">✓</div>
                    </div>
                    <div style="margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 18px; margin-right: 12px;">🔊</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Voice Recognition</span>
                        </div>
                        <div style="color: #4CAF50; font-size: 18px;">✓</div>
                    </div>
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 18px; margin-right: 12px;">🛡️</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Call Screening</span>
                        </div>
                        <div style="color: #4CAF50; font-size: 18px;">✓</div>
                    </div>
                </div>
                
                <div style="background: white; border-radius: 16px; padding: 20px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                        <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin: 0;">BLOCKED CALLS (6)</h3>
                        <button id="select-all-btn" onclick="selectAllBlockedCalls()" style="background: #007AFF; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500; display: none;">Select All</button>
                    </div>
                    
                    <div style="text-align: center; margin-bottom: 20px;">
                        <button id="select-multiple-btn" onclick="toggleSelectMultiple()" style="background: #007AFF; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 14px; font-weight: 500;">Select Multiple</button>
                    </div>
                    
                    <div id="bulk-actions" style="display: none; text-align: center; margin-bottom: 20px; padding: 16px; background: #F8F9FA; border-radius: 12px; border: 1px solid #E5E5EA;">
                        <div style="margin-bottom: 12px; font-size: 14px; color: #8E8E93;" id="selection-count">0 calls selected</div>
                        <div style="display: flex; gap: 8px; justify-content: center;">
                            <button onclick="performBulkAction('whitelist')" style="background: #4CAF50; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500;">Whitelist Selected</button>
                            <button onclick="performBulkAction('remove')" style="background: #FF3B30; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500;">Remove Selected</button>
                        </div>
                    </div>
                    
                    <div class="blocked-calls-list" id="blocked-calls-list">
                        <div class="blocked-call-item" data-number="5559998888" style="display: flex; align-items: center; margin-bottom: 16px;">
                            <input type="checkbox" class="call-checkbox" style="display: none; margin-right: 12px;" onchange="updateSelectAllButton()">
                            <div style="width: 40px; height: 40px; background: #FF3B30; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: white; font-size: 18px;">!</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #1C1C1E;">(555) 999-8888</div>
                                <div style="font-size: 14px; color: #8E8E93;">Blocked 2 hours ago • Failed authentication</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="whitelistNumber('5559998888')" style="background: #4CAF50; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px;">Whitelist</button>
                                <button onclick="removeBlockedCall('5559998888')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        
                        <div class="blocked-call-item" data-number="5551230000" style="display: flex; align-items: center; margin-bottom: 16px;">
                            <input type="checkbox" class="call-checkbox" style="display: none; margin-right: 12px;" onchange="updateSelectAllButton()">
                            <div style="width: 40px; height: 40px; background: #FF3B30; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: white; font-size: 18px;">!</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #1C1C1E;">(555) 123-0000</div>
                                <div style="font-size: 14px; color: #8E8E93;">Blocked 1 day ago • Unknown caller</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="whitelistNumber('5551230000')" style="background: #4CAF50; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px;">Whitelist</button>
                                <button onclick="removeBlockedCall('5551230000')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        
                        <div class="blocked-call-item" data-number="5557774444" style="display: flex; align-items: center; margin-bottom: 16px;">
                            <input type="checkbox" class="call-checkbox" style="display: none; margin-right: 12px;" onchange="updateSelectAllButton()">
                            <div style="width: 40px; height: 40px; background: #FF3B30; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: white; font-size: 18px;">!</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #1C1C1E;">(555) 777-4444</div>
                                <div style="font-size: 14px; color: #8E8E93;">Blocked 3 days ago • Spam detected</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="whitelistNumber('5557774444')" style="background: #4CAF50; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px;">Whitelist</button>
                                <button onclick="removeBlockedCall('5557774444')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        
                        <div class="blocked-call-item" data-number="5552345678" style="display: flex; align-items: center; margin-bottom: 16px;">
                            <input type="checkbox" class="call-checkbox" style="display: none; margin-right: 12px;" onchange="updateSelectAllButton()">
                            <div style="width: 40px; height: 40px; background: #FF3B30; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: white; font-size: 18px;">!</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #1C1C1E;">(555) 234-5678</div>
                                <div style="font-size: 14px; color: #8E8E93;">Blocked 5 hours ago • Invalid PIN</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="whitelistNumber('5552345678')" style="background: #4CAF50; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px;">Whitelist</button>
                                <button onclick="removeBlockedCall('5552345678')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        
                        <div class="blocked-call-item" data-number="5558765432" style="display: flex; align-items: center; margin-bottom: 16px;">
                            <input type="checkbox" class="call-checkbox" style="display: none; margin-right: 12px;" onchange="updateSelectAllButton()">
                            <div style="width: 40px; height: 40px; background: #FF3B30; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: white; font-size: 18px;">!</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #1C1C1E;">(555) 876-5432</div>
                                <div style="font-size: 14px; color: #8E8E93;">Blocked 30 minutes ago • Suspicious activity</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="whitelistNumber('5558765432')" style="background: #4CAF50; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px;">Whitelist</button>
                                <button onclick="removeBlockedCall('5558765432')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                        
                        <div class="blocked-call-item" data-number="5553219876" style="display: flex; align-items: center; margin-bottom: 16px;">
                            <input type="checkbox" class="call-checkbox" style="display: none; margin-right: 12px;" onchange="updateSelectAllButton()">
                            <div style="width: 40px; height: 40px; background: #FF3B30; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; color: white; font-size: 18px;">!</div>
                            <div style="flex: 1;">
                                <div style="font-size: 16px; font-weight: 600; color: #1C1C1E;">(555) 321-9876</div>
                                <div style="font-size: 14px; color: #8E8E93;">Blocked 15 minutes ago • Too many attempts</div>
                            </div>
                            <div style="display: flex; gap: 8px;">
                                <button onclick="whitelistNumber('5553219876')" style="background: #4CAF50; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px;">Whitelist</button>
                                <button onclick="removeBlockedCall('5553219876')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 4px 8px; font-size: 12px; cursor: pointer;">Remove</button>
                            </div>
                        </div>
                    </div>
                    
                    <div style="text-align: center; margin-top: 16px; padding-top: 16px; border-top: 1px solid #E5E5EA;">
                        <div style="font-size: 14px; color: #8E8E93;">Blocked calls are automatically removed after 30 days</div>
                    </div>
                </div>
            </div>

            <!-- Contacts Screen -->
            <div class="screen" id="contacts-screen">
                <h1 style="text-align: center; font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 30px;">Trusted Contacts</h1>
                
                <div style="background: #E8F5E8; border-radius: 12px; padding: 16px; margin-bottom: 24px; display: flex; align-items: center;">
                    <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🛡️</div>
                    <span style="font-size: 14px; color: #4CAF50; font-weight: 500;">Trusted contacts bypass screening</span>
                </div>
                
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px;">
                    <h3 style="font-size: 18px; font-weight: 600; color: #1C1C1E; margin: 0;">Trusted Contacts (<span id="contact-count">2</span>)</h3>
                    <button id="select-all-contacts-btn" onclick="selectAllContacts()" style="background: #007AFF; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500; cursor: pointer;">Select All</button>
                </div>
                
                <div style="text-align: center; margin-bottom: 24px;">
                    <button id="select-multiple-contacts-btn" onclick="toggleContactSelection()" style="background: #007AFF; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 14px; font-weight: 500; cursor: pointer;">Select Multiple</button>
                </div>
                
                <!-- Bulk Actions for Contacts -->
                <div id="contact-bulk-actions" style="display: none; text-align: center; margin-bottom: 20px; padding: 16px; background: #F8F9FA; border-radius: 12px; border: 1px solid #E5E5EA;">
                    <div style="margin-bottom: 12px; font-size: 14px; color: #8E8E93;" id="contact-selection-count">0 contacts selected</div>
                    <div style="display: flex; gap: 8px; justify-content: center;">
                        <button onclick="performContactBulkAction('remove')" style="background: #FF3B30; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500; cursor: pointer;">Remove Selected</button>
                    </div>
                </div>
                
                <div id="contacts-list">
                    <div class="contact-item" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <input type="checkbox" class="contact-checkbox" style="display: none; margin-right: 12px;" onchange="updateContactSelectAllButton()">
                        <div style="width: 40px; height: 40px; background: #007AFF; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 18px; font-weight: 600; color: white;">J</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">John Smith</div>
                            <div style="font-size: 14px; color: #8E8E93;">(555) 123-4567</div>
                        </div>
                        <button onclick="removeContact('john')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 500; cursor: pointer;">Remove</button>
                    </div>
                    
                    <div class="contact-item" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                        <input type="checkbox" class="contact-checkbox" style="display: none; margin-right: 12px;" onchange="updateContactSelectAllButton()">
                        <div style="width: 40px; height: 40px; background: #007AFF; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 18px; font-weight: 600; color: white;">M</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">Mary Johnson</div>
                            <div style="font-size: 14px; color: #8E8E93;">(555) 987-6543</div>
                        </div>
                        <button onclick="removeContact('mary')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 500; cursor: pointer;">Remove</button>
                    </div>
                </div>
                
                <div style="display: none;" id="add-contact-form">
                    <div class="form-group" style="margin-top: 20px;">
                        <label class="form-label">Add Contact</label>
                        <input type="text" id="contact-name" class="form-input" placeholder="Contact Name">
                        <input type="tel" id="contact-phone" class="form-input" placeholder="Phone Number" style="margin-top: 8px;">
                        <button class="btn" onclick="addContact()" style="margin-top: 8px;">Add to Trusted List</button>
                    </div>
                </div>
            </div>

            <!-- Settings Screen -->
            <div class="screen" id="settings-screen">
                <h1 style="text-align: center; font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 40px;">CallBunker</h1>
                
                <div class="settings-list">
                    <div class="settings-item" onclick="showScreen('security-settings-screen')" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer;">
                        <div style="width: 40px; height: 40px; background: #F8F9FA; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 16px; font-size: 18px;">🛡️</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">Security Settings</div>
                            <div style="font-size: 14px; color: #8E8E93;">PIN: 8322, Verbal: "Black widow"</div>
                        </div>
                    </div>
                    
                    <div class="settings-item" onclick="showScreen('privacy-protection-screen')" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer;">
                        <div style="width: 40px; height: 40px; background: #F8F9FA; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 16px; font-size: 18px;">🛡️</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">Privacy Protection</div>
                            <div style="font-size: 14px; color: #8E8E93;">Call Screening & Authentication</div>
                        </div>
                    </div>
                    
                    <div class="settings-item" onclick="showScreen('about-callbunker-screen')" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); cursor: pointer;">
                        <div style="width: 40px; height: 40px; background: #F8F9FA; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin-right: 16px; font-size: 18px;">ℹ️</div>
                        <div style="flex: 1;">
                            <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">About CallBunker</div>
                            <div style="font-size: 14px; color: #8E8E93;">Version 1.0.0</div>
                        </div>
                    </div>
                </div>
                
            </div>
            
            <!-- Security Settings Detail Screen -->
            <div class="screen" id="security-settings-screen">
                <div style="display: flex; align-items: center; margin-bottom: 30px;">
                    <button onclick="showScreen('settings-screen')" style="background: none; border: none; color: #007AFF; font-size: 16px; margin-right: 8px; cursor: pointer;">← Back</button>
                    <h1 style="font-size: 24px; font-weight: 600; color: #1C1C1E; margin: 0;">Security Settings</h1>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">PIN AUTHENTICATION</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px; margin-bottom: 8px;">
                        <!-- Display Mode -->
                        <div id="pin-display-mode" style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div id="pin-display" style="font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 4px;">8322</div>
                                <div style="font-size: 14px; color: #8E8E93;">4-digit numeric code for call authentication</div>
                            </div>
                            <button onclick="editPin()" style="background: #007AFF; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500; cursor: pointer;">Edit</button>
                        </div>
                        <!-- Edit Mode -->
                        <div id="pin-edit-mode" style="display: none;">
                            <input id="pin-input" type="text" maxlength="4" pattern="[0-9]{4}" style="width: 100%; padding: 12px; border: 2px solid #E5E5EA; border-radius: 8px; font-size: 18px; font-weight: 600; margin-bottom: 8px; outline: none;" placeholder="Enter 4-digit PIN">
                            <div style="font-size: 14px; color: #8E8E93; margin-bottom: 16px;">4-digit numeric code for call authentication</div>
                            <div style="display: flex; gap: 12px;">
                                <button onclick="savePinEdit()" style="background: #4CAF50; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 14px; font-weight: 500; cursor: pointer; flex: 1;">Save</button>
                                <button onclick="cancelPinEdit()" style="background: #8E8E93; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 14px; font-weight: 500; cursor: pointer; flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">VERBAL CODE</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px; margin-bottom: 8px;">
                        <!-- Display Mode -->
                        <div id="verbal-display-mode" style="display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div id="verbal-display" style="font-size: 18px; font-weight: 600; color: #1C1C1E; margin-bottom: 4px;">Black widow</div>
                                <div style="font-size: 14px; color: #8E8E93;">Spoken phrase for voice authentication</div>
                            </div>
                            <button onclick="editVerbalCode()" style="background: #007AFF; color: white; border: none; border-radius: 8px; padding: 8px 16px; font-size: 14px; font-weight: 500; cursor: pointer;">Edit</button>
                        </div>
                        <!-- Edit Mode -->
                        <div id="verbal-edit-mode" style="display: none;">
                            <input id="verbal-input" type="text" style="width: 100%; padding: 12px; border: 2px solid #E5E5EA; border-radius: 8px; font-size: 16px; font-weight: 600; margin-bottom: 8px; outline: none;" placeholder="Enter verbal code">
                            <div style="font-size: 14px; color: #8E8E93; margin-bottom: 16px;">Spoken phrase for voice authentication</div>
                            <div style="display: flex; gap: 12px;">
                                <button onclick="saveVerbalEdit()" style="background: #4CAF50; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 14px; font-weight: 500; cursor: pointer; flex: 1;">Save</button>
                                <button onclick="cancelVerbalEdit()" style="background: #8E8E93; color: white; border: none; border-radius: 8px; padding: 10px 20px; font-size: 14px; font-weight: 500; cursor: pointer; flex: 1;">Cancel</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">AUTHENTICATION METHODS</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px;">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="font-size: 18px; margin-right: 12px;">🔢</div>
                            <span style="font-size: 16px; color: #1C1C1E;">PIN Code Entry</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="font-size: 18px; margin-right: 12px;">🔊</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Verbal Recognition</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 18px; margin-right: 12px;">⚡</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Dual Verification Support</span>
                        </div>
                    </div>
                </div>
                
                <div>
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">SECURITY FEATURES</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px;">
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="font-size: 18px; margin-right: 12px;">🛡️</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Call Screening Protection</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 12px;">
                            <div style="font-size: 18px; margin-right: 12px;">📱</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Rate Limiting & Blocking</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 18px; margin-right: 12px;">✅</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Smart Trusted Caller Whitelist</span>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Privacy Protection Detail Screen -->
            <div class="screen" id="privacy-protection-screen">
                <div style="display: flex; align-items: center; margin-bottom: 30px;">
                    <button onclick="showScreen('settings-screen')" style="background: none; border: none; color: #007AFF; font-size: 16px; margin-right: 8px; cursor: pointer;">← Back</button>
                    <h1 style="font-size: 24px; font-weight: 600; color: #1C1C1E; margin: 0;">Privacy Protection</h1>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">DEFENSE NUMBER</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px;">
                        <div style="font-size: 20px; font-weight: 600; color: #1C1C1E; margin-bottom: 4px;">+1 (617) 942-1250</div>
                        <div style="font-size: 14px; color: #8E8E93;">Your protected communication number</div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">CALL SCREENING STATUS</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px; display: flex; align-items: center;">
                        <div style="margin-right: 12px;">✅</div>
                        <div>
                            <div style="font-size: 16px; font-weight: 600; color: #4CAF50; margin-bottom: 2px;">Active Protection</div>
                            <div style="font-size: 14px; color: #8E8E93;">All incoming calls are authenticated before connecting</div>
                        </div>
                    </div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">AUTHENTICATION METHODS</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center;">
                                <div style="font-size: 18px; margin-right: 12px;">🔢</div>
                                <span style="font-size: 16px; color: #1C1C1E;">PIN Code Verification</span>
                            </div>
                            <span style="font-size: 14px; font-weight: 600; color: #4CAF50;">ACTIVE</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center;">
                                <div style="font-size: 18px; margin-right: 12px;">🔊</div>
                                <span style="font-size: 16px; color: #1C1C1E;">Voice Recognition</span>
                            </div>
                            <span style="font-size: 14px; font-weight: 600; color: #4CAF50;">ACTIVE</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                            <div style="display: flex; align-items: center;">
                                <div style="font-size: 18px; margin-right: 12px;">⚡</div>
                                <span style="font-size: 16px; color: #1C1C1E;">Trusted Contacts Bypass</span>
                            </div>
                            <span style="font-size: 14px; font-weight: 600; color: #4CAF50;">ENABLED</span>
                        </div>
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <div style="display: flex; align-items: center;">
                                <div style="font-size: 18px; margin-right: 12px;">🚫</div>
                                <span style="font-size: 16px; color: #1C1C1E;">Auto-Block Failed Attempts</span>
                            </div>
                            <span style="font-size: 14px; font-weight: 600; color: #4CAF50;">ENABLED</span>
                        </div>
                    </div>
                </div>
                
                <div style="background: #E8F5E8; border-radius: 12px; padding: 16px; display: flex; align-items: center;">
                    <div style="width: 24px; height: 24px; background: #4CAF50; border-radius: 6px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 14px; color: white;">🛡️</div>
                    <span style="font-size: 14px; color: #4CAF50; font-weight: 500;">Advanced call screening protects you from unwanted callers</span>
                </div>
            </div>
            
            <!-- About CallBunker Detail Screen -->
            <div class="screen" id="about-callbunker-screen">
                <div style="display: flex; align-items: center; margin-bottom: 30px;">
                    <button onclick="showScreen('settings-screen')" style="background: none; border: none; color: #007AFF; font-size: 16px; margin-right: 8px; cursor: pointer;">← Back</button>
                    <h1 style="font-size: 24px; font-weight: 600; color: #1C1C1E; margin: 0;">About CallBunker</h1>
                </div>
                
                <div style="text-align: center; margin-bottom: 40px;">
                    <div style="width: 80px; height: 80px; background: #007AFF; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin: 0 auto 16px; font-size: 36px; color: white;">🛡️</div>
                    <h2 style="font-size: 24px; font-weight: 600; color: #1C1C1E; margin-bottom: 8px;">CallBunker</h2>
                    <p style="font-size: 16px; color: #8E8E93; margin: 0;">Advanced Communication Security</p>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">VERSION INFORMATION</h3>
                    <div style="font-size: 20px; font-weight: 600; color: #1C1C1E;">1.0.0</div>
                </div>
                
                <div style="margin-bottom: 30px;">
                    <h3 style="font-size: 14px; font-weight: 500; color: #8E8E93; text-transform: uppercase; margin-bottom: 12px;">CORE FEATURES</h3>
                    <div style="background: white; border-radius: 12px; padding: 16px;">
                        <div style="display: flex; align-items: center; margin-bottom: 16px;">
                            <div style="font-size: 18px; margin-right: 12px;">🛡️</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Call Screening with PIN/Verbal Auth</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 16px;">
                            <div style="font-size: 18px; margin-right: 12px;">📞</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Protected Native Calling</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 16px;">
                            <div style="font-size: 18px; margin-right: 12px;">💬</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Secure Messaging (Coming Soon)</span>
                        </div>
                        <div style="display: flex; align-items: center; margin-bottom: 16px;">
                            <div style="font-size: 18px; margin-right: 12px;">👥</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Trusted Contacts Management</span>
                        </div>
                        <div style="display: flex; align-items: center;">
                            <div style="font-size: 18px; margin-right: 12px;">📊</div>
                            <span style="font-size: 16px; color: #1C1C1E;">Call History & Analytics</span>
                        </div>
                    </div>
                </div>
                
                <p style="font-size: 14px; color: #8E8E93; text-align: center; line-height: 1.5;">CallBunker provides comprehensive communication security through advanced call screening, privacy protection, and intelligent contact management. Your real phone number stays completely hidden while maintaining full functionality.</p>
            </div>

            <!-- Tab Navigation -->
            <div class="tab-navigation">
                <button class="tab-btn" onclick="showScreen('home-screen')" id="home-tab">
                    <div class="tab-icon">🏠</div>
                    <div>Home</div>
                </button>
                <button class="tab-btn" onclick="showScreen('dialer-screen')" id="dialer-tab">
                    <div class="tab-icon">📞</div>
                    <div>Dialer</div>
                </button>
                <button class="tab-btn" onclick="showScreen('history-screen')" id="history-tab">
                    <div class="tab-icon">📊</div>
                    <div>Analytics</div>
                </button>
                <button class="tab-btn" onclick="showScreen('contacts-screen')" id="contacts-tab">
                    <div class="tab-icon">👥</div>
                    <div>Contacts</div>
                </button>
                <button class="tab-btn" onclick="showScreen('settings-screen')" id="settings-tab">
                    <div class="tab-icon">⚙️</div>
                    <div>Settings</div>
                </button>
            </div>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="success-modal" id="success-modal">
        <div class="modal-content">
            <div class="modal-icon">✅</div>
            <h3 class="modal-title">Account Created!</h3>
            <p class="modal-text">Welcome to CallBunker! Your Defense Number is:</p>
            <div class="defense-number" id="modal-defense-number">(631) 641-7728</div>
            <button class="btn" onclick="closeSuccessModal()">Get Started</button>
        </div>
    </div>

    <script>
        let currentUser = null;
        let phoneNumber = '';
        
        function showScreen(screenId) {
            // Hide all screens
            document.querySelectorAll('.screen').forEach(screen => {
                screen.classList.remove('active');
            });
            
            // Show selected screen
            document.getElementById(screenId).classList.add('active');
            
            // Update tab navigation
            document.querySelectorAll('.tab-btn').forEach(tab => {
                tab.classList.remove('active');
            });
            
            const tabMap = {
                'home-screen': 'home-tab',
                'dialer-screen': 'dialer-tab',
                'history-screen': 'history-tab',
                'contacts-screen': 'contacts-tab',
                'settings-screen': 'settings-tab',
                'security-settings-screen': 'settings-tab',
                'privacy-protection-screen': 'settings-tab',
                'about-callbunker-screen': 'settings-tab'
            };
            
            if (tabMap[screenId]) {
                document.getElementById(tabMap[screenId]).classList.add('active');
            }
            
            // Load contacts when switching to contacts screen
            if (screenId === 'contacts-screen') {
                loadContactsScreen();
            }
        }
        
        function updateUserInfo() {
            if (currentUser) {
                // Update stats on home screen only
                document.getElementById('blocked-calls').textContent = '6';
                document.getElementById('trusted-contacts').textContent = '2';
            }
        }
        
        function showSecuritySettings() {
            showScreen('security-settings-screen');
        }
        
        function showPrivacyProtection() {
            showScreen('privacy-protection-screen');
        }
        
        function showAboutCallBunker() {
            showScreen('about-callbunker-screen');
        }
        
        async function removeContact(contactId) {
            // Show confirmation dialog
            const confirmed = await showConfirmDialog(
                'Remove Contact', 
                'Remove this contact from trusted list?'
            );
            
            if (!confirmed) return;
            
            try {
                // Actually remove from backend
                const response = await fetch(`/demo/api/contacts/${contactId}`, {
                    method: 'DELETE',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });
                
                if (response.ok) {
                    // Remove from UI with animation
                    const contactItem = event.target.closest('.contact-item');
                    if (contactItem) {
                        contactItem.style.transform = 'translateX(-100%)';
                        contactItem.style.opacity = '0';
                        contactItem.style.transition = 'all 0.3s ease';
                        
                        setTimeout(() => {
                            contactItem.style.display = 'none';
                            const count = document.getElementById('contact-count');
                            const currentCount = parseInt(count.textContent);
                            count.textContent = Math.max(0, currentCount - 1);
                        }, 300);
                        
                        showStatusMessage('✅ Contact removed successfully!', 'success');
                    }
                } else {
                    showStatusMessage('❌ Failed to remove contact', 'error');
                }
            } catch (error) {
                console.error('Error removing contact:', error);
                showStatusMessage('❌ Error removing contact', 'error');
            }
        }
        
        // DTMF Tone frequencies (Hz)
        const dtmfTones = {
            '1': [697, 1209], '2': [697, 1336], '3': [697, 1477],
            '4': [770, 1209], '5': [770, 1336], '6': [770, 1477],
            '7': [852, 1209], '8': [852, 1336], '9': [852, 1477],
            '*': [941, 1209], '0': [941, 1336], '#': [941, 1477]
        };
        
        // Create persistent audio context to avoid suspension issues
        let audioContext = null;
        
        function initAudioContext() {
            if (!audioContext) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                } catch (error) {
                    console.log('Audio context not available');
                    return false;
                }
            }
            
            // Resume context if suspended
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
            
            return audioContext.state === 'running' || audioContext.state === 'suspended';
        }
        
        function playTone(digit) {
            if (!dtmfTones[digit]) return;
            
            if (!initAudioContext()) {
                console.log('Audio context not available for:', digit);
                return;
            }
            
            try {
                const [lowFreq, highFreq] = dtmfTones[digit];
                
                // Create oscillators for the two frequencies
                const oscillator1 = audioContext.createOscillator();
                const oscillator2 = audioContext.createOscillator();
                const gainNode = audioContext.createGain();
                
                oscillator1.frequency.setValueAtTime(lowFreq, audioContext.currentTime);
                oscillator2.frequency.setValueAtTime(highFreq, audioContext.currentTime);
                
                oscillator1.connect(gainNode);
                oscillator2.connect(gainNode);
                gainNode.connect(audioContext.destination);
                
                // Set volume and duration
                gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.15);
                
                oscillator1.start(audioContext.currentTime);
                oscillator2.start(audioContext.currentTime);
                oscillator1.stop(audioContext.currentTime + 0.15);
                oscillator2.stop(audioContext.currentTime + 0.15);
                
            } catch (error) {
                console.log('Error playing tone for:', digit, error);
            }
        }
        
        // Security Analytics functionality
        let selectMultipleMode = false;
        
        function toggleSelectMultiple() {
            const btn = document.getElementById('select-multiple-btn');
            const checkboxes = document.querySelectorAll('.call-checkbox');
            const selectAllBtn = document.getElementById('select-all-btn');
            const bulkActions = document.getElementById('bulk-actions');
            
            selectMultipleMode = !selectMultipleMode;
            
            if (selectMultipleMode) {
                btn.textContent = 'Cancel Selection';
                btn.style.background = '#FF3B30';
                selectAllBtn.style.display = 'inline-block';
                bulkActions.style.display = 'block';
                checkboxes.forEach(cb => cb.style.display = 'inline-block');
            } else {
                btn.textContent = 'Select Multiple';
                btn.style.background = '#007AFF';
                selectAllBtn.style.display = 'none';
                bulkActions.style.display = 'none';
                checkboxes.forEach(cb => {
                    cb.style.display = 'none';
                    cb.checked = false;
                });
            }
            updateSelectionCount();
        }
        
        function selectAllBlockedCalls() {
            if (!selectMultipleMode) return;
            
            const checkboxes = document.querySelectorAll('.call-checkbox');
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            
            checkboxes.forEach(cb => cb.checked = !allChecked);
            updateSelectAllButton();
        }
        
        function updateSelectAllButton() {
            const checkboxes = document.querySelectorAll('.call-checkbox');
            const selectAllBtn = document.getElementById('select-all-btn');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            
            if (checkedCount === 0) {
                selectAllBtn.textContent = 'Select All';
            } else if (checkedCount === checkboxes.length) {
                selectAllBtn.textContent = 'Deselect All';
            } else {
                selectAllBtn.textContent = `Selected (${checkedCount})`;
            }
            updateSelectionCount();
        }
        
        function updateSelectionCount() {
            const checkboxes = document.querySelectorAll('.call-checkbox');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            const selectionCount = document.getElementById('selection-count');
            if (selectionCount) {
                selectionCount.textContent = `${checkedCount} call${checkedCount !== 1 ? 's' : ''} selected`;
            }
        }
        
        function whitelistNumber(number) {
            const formattedNumber = formatPhoneNumber(number);
            const item = document.querySelector(`.blocked-call-item[data-number="${number}"]`);
            
            if (item) {
                // Add success animation
                item.style.transform = 'translateX(10px)';
                item.style.background = 'linear-gradient(90deg, #E8F5E8 0%, #D4F4DD 100%)';
                item.style.border = '2px solid #4CAF50';
                item.style.borderRadius = '12px';
                item.style.transition = 'all 0.3s ease';
                
                // Show success feedback
                const successDiv = document.createElement('div');
                successDiv.innerHTML = `
                    <div style="display: flex; align-items: center; color: #4CAF50; font-weight: 600; font-size: 14px;">
                        <span style="font-size: 18px; margin-right: 8px;">✅</span>
                        Added to Trusted Contacts!
                    </div>
                `;
                successDiv.style.cssText = 'position: absolute; top: 10px; right: 10px; background: white; padding: 8px 12px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 1000;';
                document.body.appendChild(successDiv);
                
                setTimeout(() => {
                    item.style.transform = 'translateX(-100%)';
                    item.style.opacity = '0';
                    
                    setTimeout(() => {
                        item.style.display = 'none';
                        updateBlockedCount();
                        
                        // Add to whitelist and update trusted contacts count
                        addToWhitelist(formattedNumber);
                    }, 300);
                }, 1200);
                
                // Remove success notification
                setTimeout(() => {
                    if (document.body.contains(successDiv)) {
                        successDiv.style.opacity = '0';
                        setTimeout(() => document.body.removeChild(successDiv), 300);
                    }
                }, 2000);
            }
        }
        
        function removeBlockedCall(number) {
            const formattedNumber = formatPhoneNumber(number);
            const item = document.querySelector(`.blocked-call-item[data-number="${number}"]`);
            
            if (item) {
                // Add removal animation
                item.style.transform = 'translateX(-10px)';
                item.style.background = 'linear-gradient(90deg, #FFE5E5 0%, #FFCDD2 100%)';
                item.style.border = '2px solid #FF3B30';
                item.style.borderRadius = '12px';
                item.style.transition = 'all 0.3s ease';
                
                // Show removal feedback
                const removalDiv = document.createElement('div');
                removalDiv.innerHTML = `
                    <div style="display: flex; align-items: center; color: #FF3B30; font-weight: 600; font-size: 14px;">
                        <span style="font-size: 18px; margin-right: 8px;">🗑️</span>
                        Removed from list!
                    </div>
                `;
                removalDiv.style.cssText = 'position: absolute; top: 10px; right: 10px; background: white; padding: 8px 12px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); z-index: 1000;';
                document.body.appendChild(removalDiv);
                
                setTimeout(() => {
                    item.style.transform = 'translateX(100%)';
                    item.style.opacity = '0';
                    
                    setTimeout(() => {
                        item.style.display = 'none';
                        updateBlockedCount();
                    }, 300);
                }, 1000);
                
                // Remove notification
                setTimeout(() => {
                    if (document.body.contains(removalDiv)) {
                        removalDiv.style.opacity = '0';
                        setTimeout(() => document.body.removeChild(removalDiv), 300);
                    }
                }, 2000);
            }
        }
        
        function formatPhoneNumber(number) {
            // Convert 5559998888 to (555) 999-8888
            const cleaned = number.replace(/\D/g, '');
            if (cleaned.length === 10) {
                return `(${cleaned.slice(0, 3)}) ${cleaned.slice(3, 6)}-${cleaned.slice(6)}`;
            }
            return number;
        }
        
        function updateBlockedCount() {
            const visibleItems = document.querySelectorAll('.blocked-call-item:not([style*="display: none"])');
            const count = visibleItems.length;
            const blockedCallsElement = document.getElementById('blocked-calls');
            if (blockedCallsElement) {
                blockedCallsElement.textContent = count;
            }
            
            // Update header count
            const header = document.querySelector('h3[style*="BLOCKED CALLS"]');
            if (header) {
                header.innerHTML = `BLOCKED CALLS (${count})`;
            }
        }
        
        // Settings toggle functionality
        function toggleSetting(settingId, element) {
            const isEnabled = element.getAttribute('data-enabled') === 'true';
            const newState = !isEnabled;
            
            element.setAttribute('data-enabled', newState);
            const slider = element.querySelector('.toggle-slider');
            
            if (newState) {
                element.style.background = '#4CAF50';
                slider.style.right = '2px';
                slider.style.left = 'auto';
            } else {
                element.style.background = '#E5E5EA';
                slider.style.left = '2px';
                slider.style.right = 'auto';
            }
            
            // Show feedback
            const settingNames = {
                'pin-auth': 'PIN Authentication',
                'voice-recognition': 'Voice Recognition',
                'call-screening': 'Call Screening',
                'notifications': 'Notifications'
            };
            
            const settingName = settingNames[settingId] || 'Setting';
            const status = newState ? 'enabled' : 'disabled';
            console.log(`${settingName} ${status}`);
        }
        
        // Bulk actions for selected blocked calls
        function performBulkAction(action) {
            const selectedCheckboxes = document.querySelectorAll('.call-checkbox:checked');
            if (selectedCheckboxes.length === 0) {
                showStatusMessage('No calls selected', 'error');
                return;
            }
            
            const numbers = Array.from(selectedCheckboxes).map(cb => 
                cb.closest('.blocked-call-item').getAttribute('data-number')
            );
            
            if (action === 'whitelist') {
                // Show success feedback immediately
                const count = numbers.length;
                showStatusMessage(`✅ Adding ${count} number${count !== 1 ? 's' : ''} to Trusted Contacts...`, 'success');
                
                numbers.forEach((number, index) => {
                    setTimeout(() => {
                        const item = document.querySelector(`.blocked-call-item[data-number="${number}"]`);
                        if (item) {
                            item.style.transform = 'translateX(10px)';
                            item.style.background = 'linear-gradient(90deg, #E8F5E8 0%, #D4F4DD 100%)';
                            item.style.border = '2px solid #4CAF50';
                            item.style.borderRadius = '12px';
                            item.style.transition = 'all 0.3s ease';
                            
                            setTimeout(() => {
                                item.style.transform = 'translateX(-100%)';
                                item.style.opacity = '0';
                                
                                setTimeout(() => {
                                    item.style.display = 'none';
                                    updateBlockedCount();
                                }, 300);
                            }, 800);
                        }
                    }, index * 200);
                });
                
                // Add to whitelist and update trusted contacts count
                setTimeout(() => {
                    // Add each number to the whitelist
                    numbers.forEach(number => {
                        addToWhitelist(number);
                    });
                    
                    // Exit selection mode
                    toggleSelectMultiple();
                    showStatusMessage(`✅ ${numbers.length} number${numbers.length !== 1 ? 's' : ''} added to Trusted Contacts!`, 'success');
                }, numbers.length * 200 + 1000);
                
            } else if (action === 'remove') {
                const count = numbers.length;
                showStatusMessage(`🗑️ Removing ${count} number${count !== 1 ? 's' : ''}...`, 'info');
                
                numbers.forEach((number, index) => {
                    setTimeout(() => {
                        const item = document.querySelector(`.blocked-call-item[data-number="${number}"]`);
                        if (item) {
                            item.style.transform = 'translateX(-10px)';
                            item.style.background = 'linear-gradient(90deg, #FFE5E5 0%, #FFCDD2 100%)';
                            item.style.border = '2px solid #FF3B30';
                            item.style.borderRadius = '12px';
                            item.style.transition = 'all 0.3s ease';
                            
                            setTimeout(() => {
                                item.style.transform = 'translateX(100%)';
                                item.style.opacity = '0';
                                
                                setTimeout(() => {
                                    item.style.display = 'none';
                                    updateBlockedCount();
                                }, 300);
                            }, 800);
                        }
                    }, index * 200);
                });
                
                setTimeout(() => {
                    // Exit selection mode
                    toggleSelectMultiple();
                    showStatusMessage(`🗑️ ${numbers.length} number${numbers.length !== 1 ? 's' : ''} removed!`, 'info');
                }, numbers.length * 200 + 1000);
            }
        }
        
        function showStatusMessage(message, type = 'info') {
            const statusDiv = document.createElement('div');
            statusDiv.innerHTML = `
                <div style="display: flex; align-items: center; font-weight: 600; font-size: 14px; color: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#FF3B30' : '#007AFF'};">
                    ${message}
                </div>
            `;
            statusDiv.style.cssText = 'position: fixed; top: 20px; left: 50%; transform: translateX(-50%); background: white; padding: 12px 24px; border-radius: 25px; box-shadow: 0 6px 24px rgba(0,0,0,0.15); z-index: 10000; border: 2px solid ' + (type === 'success' ? '#4CAF50' : type === 'error' ? '#FF3B30' : '#007AFF') + ';';
            document.body.appendChild(statusDiv);
            
            // Fade out after 3 seconds
            setTimeout(() => {
                if (document.body.contains(statusDiv)) {
                    statusDiv.style.opacity = '0';
                    statusDiv.style.transform = 'translateX(-50%) translateY(-20px)';
                    statusDiv.style.transition = 'all 0.3s ease';
                    setTimeout(() => {
                        if (document.body.contains(statusDiv)) {
                            document.body.removeChild(statusDiv);
                        }
                    }, 300);
                }
            }, 3000);
        }
        
        // Array to store whitelisted contacts
        let whitelistedContacts = [];
        
        // PIN and Verbal Code editing functionality
        function editPin() {
            document.getElementById('pin-display-mode').style.display = 'none';
            document.getElementById('pin-edit-mode').style.display = 'block';
            
            const currentPin = document.getElementById('pin-display').textContent;
            document.getElementById('pin-input').value = currentPin;
            document.getElementById('pin-input').focus();
        }
        
        function savePinEdit() {
            const newPin = document.getElementById('pin-input').value;
            
            if (/^\d{4}$/.test(newPin)) {
                document.getElementById('pin-display').textContent = newPin;
                document.getElementById('pin-display-mode').style.display = 'flex';
                document.getElementById('pin-edit-mode').style.display = 'none';
                showStatusMessage('✅ PIN updated successfully!', 'success');
            } else {
                showStatusMessage('❌ PIN must be exactly 4 digits', 'error');
                document.getElementById('pin-input').focus();
            }
        }
        
        function cancelPinEdit() {
            document.getElementById('pin-display-mode').style.display = 'flex';
            document.getElementById('pin-edit-mode').style.display = 'none';
        }
        
        function editVerbalCode() {
            document.getElementById('verbal-display-mode').style.display = 'none';
            document.getElementById('verbal-edit-mode').style.display = 'block';
            
            const currentCode = document.getElementById('verbal-display').textContent.trim();
            document.getElementById('verbal-input').value = currentCode;
            document.getElementById('verbal-input').focus();
        }
        
        function saveVerbalEdit() {
            const newCode = document.getElementById('verbal-input').value.trim();
            
            if (newCode.length > 0) {
                document.getElementById('verbal-display').textContent = newCode;
                document.getElementById('verbal-display-mode').style.display = 'flex';
                document.getElementById('verbal-edit-mode').style.display = 'none';
                showStatusMessage('✅ Verbal code updated successfully!', 'success');
            } else {
                showStatusMessage('❌ Verbal code cannot be empty', 'error');
                document.getElementById('verbal-input').focus();
            }
        }
        
        function cancelVerbalEdit() {
            document.getElementById('verbal-display-mode').style.display = 'flex';
            document.getElementById('verbal-edit-mode').style.display = 'none';
        }
        
        // Enhanced whitelist function that adds to contacts
        function addToWhitelist(number) {
            const formattedNumber = formatPhoneNumber(number);
            const newContact = {
                id: 'whitelist_' + Date.now(),
                name: 'Whitelisted Caller',
                phone_number: formattedNumber,
                added: 'whitelist'
            };
            whitelistedContacts.push(newContact);
            
            // Update trusted contacts count
            const trustedCount = document.getElementById('trusted-contacts');
            if (trustedCount) {
                const current = parseInt(trustedCount.textContent);
                trustedCount.textContent = current + 1;
            }
            
            return newContact;
        }
        
        function refreshContactsWithWhitelist() {
            const contactsList = document.getElementById('contacts-list');
            if (!contactsList) return;
            
            // Get existing contacts HTML
            const existingContactsHTML = `
                <div class="contact-item" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <input type="checkbox" class="contact-checkbox" style="display: ${contactSelectionMode ? 'block' : 'none'}; margin-right: 12px;" onchange="updateContactSelectAllButton()">
                    <div style="width: 40px; height: 40px; background: #007AFF; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 18px; font-weight: 600; color: white;">J</div>
                    <div style="flex: 1;">
                        <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">John Smith</div>
                        <div style="font-size: 14px; color: #8E8E93;">(555) 123-4567</div>
                    </div>
                    <button onclick="removeContact('john')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 500; cursor: pointer;">Remove</button>
                </div>
                
                <div class="contact-item" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <input type="checkbox" class="contact-checkbox" style="display: ${contactSelectionMode ? 'block' : 'none'}; margin-right: 12px;" onchange="updateContactSelectAllButton()">
                    <div style="width: 40px; height: 40px; background: #007AFF; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 18px; font-weight: 600; color: white;">M</div>
                    <div style="flex: 1;">
                        <div style="font-size: 16px; font-weight: 600; color: #1C1C1E; margin-bottom: 2px;">Mary Johnson</div>
                        <div style="font-size: 14px; color: #8E8E93;">(555) 987-6543</div>
                    </div>
                    <button onclick="removeContact('mary')" style="background: #FF3B30; color: white; border: none; border-radius: 6px; padding: 6px 12px; font-size: 12px; font-weight: 500; cursor: pointer;">Remove</button>
                </div>
            `;
            
            const whitelistHTML = whitelistedContacts.map(contact => `
                <div class="contact-item" style="display: flex; align-items: center; background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; border-left: 4px solid #4CAF50; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
                    <input type="checkbox" class="contact-checkbox" style="display: ${contactSelectionMode ? 'block' : 'none'}; margin-right: 12px;" onchange="updateContactSelectAllButton()">
                    <div style="width: 40px; height: 40px; background: #4CAF50; border-radius: 20px; display: flex; align-items: center; justify-content: center; margin-right: 12px; font-size: 18px; font-weight: 600; color: white;">${contact.name.charAt(0)}</div>
                    <div style="flex: 1;">
                        <div style="font-weight: 600; font-size: 16px; color: #1C1C1E; margin-bottom: 2px;">${contact.name}</div>
                        <div style="color: #8E8E93; font-size: 14px;">${contact.phone_number}</div>
                        <div style="color: #4CAF50; font-size: 12px; margin-top: 4px;">✅ Added from blocked calls</div>
                    </div>
                    <button onclick="removeWhitelistContact('${contact.id}')" style="background: #FF3B30; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 12px; font-weight: 500; cursor: pointer;">Remove</button>
                </div>
            `).join('');
            
            contactsList.innerHTML = whitelistHTML + existingContactsHTML;
            
            // Update the count
            const totalContacts = whitelistedContacts.length + 2; // 2 existing contacts
            const contactCount = document.getElementById('contact-count');
            if (contactCount) {
                contactCount.textContent = totalContacts;
            }
        }
        
        function removeWhitelistContact(contactId) {
            whitelistedContacts = whitelistedContacts.filter(contact => contact.id !== contactId);
            
            // Update trusted contacts count
            const trustedCount = document.getElementById('trusted-contacts');
            if (trustedCount) {
                const current = parseInt(trustedCount.textContent);
                trustedCount.textContent = Math.max(0, current - 1);
            }
            
            // Refresh the contacts display
            refreshContactsWithWhitelist();
            showStatusMessage('✅ Contact removed from trusted list', 'success');
        }
        
        
        // Load contacts when viewing contacts screen
        function loadContactsScreen() {
            refreshContactsWithWhitelist();
        }

        // Contact selection functionality
        let contactSelectionMode = false;
        
        function toggleContactSelection() {
            contactSelectionMode = !contactSelectionMode;
            const selectMultipleBtn = document.getElementById('select-multiple-contacts-btn');
            const bulkActions = document.getElementById('contact-bulk-actions');
            
            if (contactSelectionMode) {
                selectMultipleBtn.textContent = 'Cancel';
                selectMultipleBtn.style.background = '#8E8E93';
                bulkActions.style.display = 'block';
            } else {
                selectMultipleBtn.textContent = 'Select Multiple';
                selectMultipleBtn.style.background = '#007AFF';
                bulkActions.style.display = 'none';
            }
            
            // Refresh contacts to show/hide checkboxes
            refreshContactsWithWhitelist();
            
            if (!contactSelectionMode) {
                // Reset button text when exiting selection mode
                updateContactSelectAllButton();
            }
        }
        
        function selectAllContacts() {
            if (!contactSelectionMode) {
                toggleContactSelection();
                // After entering selection mode, select all
                setTimeout(() => {
                    const checkboxes = document.querySelectorAll('.contact-checkbox');
                    checkboxes.forEach(cb => {
                        cb.checked = true;
                    });
                    updateContactSelectAllButton();
                }, 100);
                return;
            }
            
            const checkboxes = document.querySelectorAll('.contact-checkbox');
            const allChecked = Array.from(checkboxes).every(cb => cb.checked);
            
            checkboxes.forEach(cb => {
                cb.checked = !allChecked;
            });
            
            updateContactSelectAllButton();
        }
        
        function updateContactSelectAllButton() {
            const checkboxes = document.querySelectorAll('.contact-checkbox');
            const selectAllBtn = document.getElementById('select-all-contacts-btn');
            const checkedCount = Array.from(checkboxes).filter(cb => cb.checked).length;
            
            if (!contactSelectionMode) {
                selectAllBtn.textContent = 'Select All';
                return;
            }
            
            if (checkedCount === 0) {
                selectAllBtn.textContent = 'Select All';
            } else if (checkedCount === checkboxes.length) {
                selectAllBtn.textContent = 'Deselect All';
            } else {
                selectAllBtn.textContent = `Selected (${checkedCount})`;
            }
            
            // Update selection count for bulk actions
            const selectionCount = document.getElementById('contact-selection-count');
            if (selectionCount) {
                selectionCount.textContent = `${checkedCount} contact${checkedCount !== 1 ? 's' : ''} selected`;
            }
        }
        
        async function performContactBulkAction(action) {
            const selectedCheckboxes = document.querySelectorAll('.contact-checkbox:checked');
            if (selectedCheckboxes.length === 0) {
                showStatusMessage('No contacts selected', 'error');
                return;
            }
            
            if (action === 'remove') {
                const count = selectedCheckboxes.length;
                
                // Show confirmation dialog
                const confirmed = await showConfirmDialog(
                    'Remove Contacts', 
                    `Remove ${count} contact${count !== 1 ? 's' : ''} from trusted list?`
                );
                
                if (!confirmed) return;
                
                showStatusMessage(`🗑️ Removing ${count} contact${count !== 1 ? 's' : ''}...`, 'info');
                
                // Get contact IDs and remove from backend
                const contactIds = Array.from(selectedCheckboxes).map(checkbox => {
                    const contactItem = checkbox.closest('.contact-item');
                    const removeBtn = contactItem.querySelector('button[onclick*="removeContact"]');
                    if (removeBtn) {
                        const onclick = removeBtn.getAttribute('onclick');
                        const match = onclick.match(/removeContact\('([^']+)'\)/);
                        return match ? match[1] : null;
                    }
                    return null;
                }).filter(id => id !== null);
                
                // Remove each contact from backend
                let successCount = 0;
                for (let i = 0; i < contactIds.length; i++) {
                    try {
                        const response = await fetch(`/demo/api/contacts/${contactIds[i]}`, {
                            method: 'DELETE',
                            headers: {
                                'Content-Type': 'application/json'
                            }
                        });
                        
                        if (response.ok) {
                            successCount++;
                        }
                    } catch (error) {
                        console.error('Error removing contact:', contactIds[i], error);
                    }
                }
                
                // Animate removal of UI elements
                selectedCheckboxes.forEach((checkbox, index) => {
                    setTimeout(() => {
                        const contactItem = checkbox.closest('.contact-item');
                        if (contactItem) {
                            contactItem.style.transform = 'translateX(-100%)';
                            contactItem.style.opacity = '0';
                            contactItem.style.transition = 'all 0.3s ease';
                            
                            setTimeout(() => {
                                contactItem.style.display = 'none';
                                const contactCount = document.getElementById('contact-count');
                                const currentCount = parseInt(contactCount.textContent);
                                contactCount.textContent = Math.max(0, currentCount - 1);
                            }, 300);
                        }
                    }, index * 200);
                });
                
                setTimeout(() => {
                    // Exit selection mode
                    toggleContactSelection();
                    if (successCount === count) {
                        showStatusMessage(`🗑️ ${count} contact${count !== 1 ? 's' : ''} removed!`, 'success');
                    } else {
                        showStatusMessage(`⚠️ ${successCount}/${count} contacts removed`, 'warning');
                    }
                }, selectedCheckboxes.length * 200 + 1000);
            }
        }
        
        // Utility functions
        function showConfirmDialog(title, message) {
            return new Promise((resolve) => {
                // Create custom modal instead of browser confirm
                const modal = document.createElement('div');
                modal.style.cssText = `
                    position: fixed;
                    top: 0;
                    left: 0;
                    right: 0;
                    bottom: 0;
                    background: rgba(0,0,0,0.5);
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    z-index: 10000;
                    padding: 20px;
                `;
                
                modal.innerHTML = `
                    <div style="background: white; border-radius: 16px; padding: 24px; max-width: 320px; width: 100%; text-align: center; box-shadow: 0 10px 30px rgba(0,0,0,0.3);">
                        <h3 style="margin: 0 0 16px 0; font-size: 18px; font-weight: 600; color: #1C1C1E;">${title}</h3>
                        <p style="margin: 0 0 24px 0; font-size: 16px; color: #3C3C43; line-height: 1.4;">${message}</p>
                        <div style="display: flex; gap: 12px;">
                            <button id="confirm-cancel" style="flex: 1; background: #F2F2F7; color: #007AFF; border: none; border-radius: 8px; padding: 12px; font-size: 16px; font-weight: 500; cursor: pointer;">Cancel</button>
                            <button id="confirm-ok" style="flex: 1; background: #FF3B30; color: white; border: none; border-radius: 8px; padding: 12px; font-size: 16px; font-weight: 500; cursor: pointer;">OK</button>
                        </div>
                    </div>
                `;
                
                document.body.appendChild(modal);
                
                document.getElementById('confirm-cancel').onclick = () => {
                    document.body.removeChild(modal);
                    resolve(false);
                };
                
                document.getElementById('confirm-ok').onclick = () => {
                    document.body.removeChild(modal);
                    resolve(true);
                };
                
                // Close on backdrop click
                modal.onclick = (e) => {
                    if (e.target === modal) {
                        document.body.removeChild(modal);
                        resolve(false);
                    }
                };
            });
        }
        
        // Signup functionality
        document.getElementById('signup-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                name: document.getElementById('name').value,
                email: document.getElementById('email').value,
                google_voice_number: document.getElementById('google_voice').value,
                real_phone_number: document.getElementById('real_phone').value,
                pin: document.getElementById('pin').value,
                verbal_code: document.getElementById('verbal_code').value
            };
            
            const statusDiv = document.getElementById('signup-status');
            statusDiv.innerHTML = '<div class="info-card">Creating account...</div>';
            
            try {
                const response = await fetch('/demo/api/signup', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentUser = result.user;
                    
                    // Show success modal
                    document.getElementById('modal-defense-number').textContent = result.user.assigned_twilio_number;
                    document.getElementById('success-modal').classList.add('active');
                } else {
                    statusDiv.innerHTML = `<div style="background: #FEF2F2; border: 1px solid #EF4444; border-radius: 12px; padding: 16px; margin: 16px 0; color: #991B1B;">Error: ${result.error}</div>`;
                }
            } catch (error) {
                statusDiv.innerHTML = `<div style="background: #FEF2F2; border: 1px solid #EF4444; border-radius: 12px; padding: 16px; margin: 16px 0; color: #991B1B;">Error: ${error.message}</div>`;
            }
        });
        
        function closeSuccessModal() {
            document.getElementById('success-modal').classList.remove('active');
            showScreen('home-screen');
            updateUserInfo();
            loadCallHistory();
            loadContacts();
        }
        
        // Dialer functionality
        function addDigit(digit) {
            phoneNumber += digit;
            document.getElementById('phone-display').textContent = formatPhoneNumber(phoneNumber);
        }
        
        function clearNumber() {
            phoneNumber = phoneNumber.slice(0, -1);
            document.getElementById('phone-display').textContent = phoneNumber || 'Enter number';
        }
        
        function formatPhoneNumber(number) {
            const cleaned = number.replace(/\D/g, '');
            const match = cleaned.match(/^(\d{3})(\d{3})(\d{4})$/);
            if (match) {
                return `(${match[1]}) ${match[2]}-${match[3]}`;
            }
            return number;
        }
        
        async function makeCall() {
            if (!phoneNumber || phoneNumber.length < 3) {
                alert('Please enter a valid phone number');
                return;
            }
            
            if (!currentUser) {
                alert('Please sign up first');
                return;
            }
            
            const confirmed = confirm(`Call ${formatPhoneNumber(phoneNumber)}?\n\nYour Google Voice number will be shown as caller ID. Your real number stays hidden.`);
            
            if (confirmed) {
                const statusDiv = document.getElementById('call-status');
                statusDiv.innerHTML = '<div class="info-card">Initiating protected call...</div>';
                
                try {
                    const response = await fetch('/demo/api/make-call', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            user_id: currentUser.id,
                            target_number: phoneNumber
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        statusDiv.innerHTML = `
                            <div style="background: #F0FDF4; border: 1px solid #4CAF50; border-radius: 12px; padding: 16px; margin: 16px 0; color: #166534;">
                                ✅ Call initiated!<br>
                                Target: ${result.target_number}<br>
                                Caller ID shown: ${result.caller_id_shown}
                            </div>
                        `;
                        phoneNumber = '';
                        document.getElementById('phone-display').textContent = 'Enter number';
                        
                        // Update stats
                        const protectedCalls = document.getElementById('protected-calls');
                        protectedCalls.textContent = parseInt(protectedCalls.textContent) + 1;
                        const totalCalls = document.getElementById('total-calls');
                        totalCalls.textContent = parseInt(totalCalls.textContent) + 1;
                        
                        setTimeout(() => {
                            statusDiv.innerHTML = '';
                            loadCallHistory();
                        }, 3000);
                    } else {
                        statusDiv.innerHTML = `<div style="background: #FEF2F2; border: 1px solid #EF4444; border-radius: 12px; padding: 16px; margin: 16px 0; color: #991B1B;">Error: ${result.error}</div>`;
                    }
                } catch (error) {
                    statusDiv.innerHTML = `<div style="background: #FEF2F2; border: 1px solid #EF4444; border-radius: 12px; padding: 16px; margin: 16px 0; color: #991B1B;">Error: ${error.message}</div>`;
                }
            }
        }
        
        // Call history functionality
        async function loadCallHistory() {
            if (!currentUser) return;
            
            try {
                const response = await fetch(`/demo/api/call-history/${currentUser.id}`);
                const result = await response.json();
                
                const historyList = document.getElementById('history-list');
                
                if (result.success && result.calls.length > 0) {
                    historyList.innerHTML = result.calls.map(call => `
                        <div style="background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; border-left: 4px solid #007AFF;">
                            <div style="display: flex; justify-content: space-between; align-items: center;">
                                <div>
                                    <div style="font-weight: 600; font-size: 16px;">${formatPhoneNumber(call.target_number)}</div>
                                    <div style="color: #8E8E93; font-size: 14px; margin-top: 4px;">
                                        📞 ${call.direction} • ${call.status}<br>
                                        🛡️ ID: ${formatPhoneNumber(call.caller_id_shown)}
                                    </div>
                                </div>
                                <div style="text-align: right; color: #8E8E93; font-size: 12px;">
                                    ${new Date(call.timestamp).toLocaleTimeString()}
                                </div>
                            </div>
                        </div>
                    `).join('');
                } else {
                    historyList.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #8E8E93;">
                            <div style="font-size: 48px; margin-bottom: 16px;">📞</div>
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">No Call History</div>
                            <div>Your protected calls will appear here</div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Failed to load call history:', error);
            }
        }
        
        // Contacts functionality
        async function loadContacts() {
            if (!currentUser) return;
            
            try {
                const response = await fetch(`/demo/api/contacts/${currentUser.id}`);
                const result = await response.json();
                
                const contactsList = document.getElementById('contacts-list');
                
                if (result.success && result.contacts.length > 0) {
                    contactsList.innerHTML = result.contacts.map(contact => `
                        <div style="background: white; border-radius: 12px; padding: 16px; margin-bottom: 12px; display: flex; justify-content: space-between; align-items: center;">
                            <div>
                                <div style="font-weight: 600; font-size: 16px;">${contact.name}</div>
                                <div style="color: #8E8E93; font-size: 14px;">${formatPhoneNumber(contact.phone_number)}</div>
                                <div style="color: #4CAF50; font-size: 12px; margin-top: 4px;">✅ Bypasses screening</div>
                            </div>
                            <button onclick="removeContact(${contact.id})" style="background: #FF3B30; color: white; border: none; padding: 8px 12px; border-radius: 8px; font-size: 12px; cursor: pointer;">Remove</button>
                        </div>
                    `).join('');
                } else {
                    contactsList.innerHTML = `
                        <div style="text-align: center; padding: 40px; color: #8E8E93;">
                            <div style="font-size: 48px; margin-bottom: 16px;">👥</div>
                            <div style="font-size: 18px; font-weight: 600; margin-bottom: 8px;">No Trusted Contacts</div>
                            <div>Add contacts to bypass call screening</div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('Failed to load contacts:', error);
            }
        }
        
        async function addContact() {
            if (!currentUser) {
                alert('Please sign up first');
                return;
            }
            
            const name = document.getElementById('contact-name').value.trim();
            const phone = document.getElementById('contact-phone').value.trim();
            
            if (!name || !phone) {
                alert('Please enter both name and phone number');
                return;
            }
            
            try {
                const response = await fetch('/demo/api/add-contact', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: currentUser.id,
                        name: name,
                        phone_number: phone
                    })
                });
                
                const result = await response.json();
                
                if (result.success) {
                    document.getElementById('contact-name').value = '';
                    document.getElementById('contact-phone').value = '';
                    loadContacts();
                    alert(`${name} added to trusted contacts`);
                } else {
                    alert(`Error: ${result.error}`);
                }
            } catch (error) {
                alert(`Error: ${error.message}`);
            }
        }
        
        async function removeContact(contactId) {
            if (confirm('Remove this contact from trusted list?')) {
                try {
                    const response = await fetch('/demo/api/remove-contact', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({
                            user_id: currentUser.id,
                            contact_id: contactId
                        })
                    });
                    
                    const result = await response.json();
                    
                    if (result.success) {
                        loadContacts();
                    } else {
                        alert(`Error: ${result.error}`);
                    }
                } catch (error) {
                    alert(`Error: ${error.message}`);
                }
            }
        }
        
        // Settings toggle functionality
        document.querySelectorAll('.setting-toggle').forEach(toggle => {
            toggle.addEventListener('click', function() {
                this.classList.toggle('active');
            });
        });
    </script>
</body>
</html>